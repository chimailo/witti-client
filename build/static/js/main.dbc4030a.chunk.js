(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{128:function(e,t,a){e.exports={editor:"Editor_editor__30U8v"}},137:function(e,t,a){e.exports={buttonWrapper:"Button_buttonWrapper__2iR1t",button:"Button_button__2wKDr",active:"Button_active__2546w"}},207:function(e,t,a){e.exports={emojiSelect:"Emoji_emojiSelect__2qKrk",emojiSelectButton:"Emoji_emojiSelectButton__I-mqy",emojiSelectButtonPressed:"Emoji_emojiSelectButtonPressed__2SZDc",emojiSelectPopover:"Emoji_emojiSelectPopover__2lLgY",emojiSelectPopoverClosed:"Emoji_emojiSelectPopoverClosed__1zbC8",emojiSelectPopoverTitle:"Emoji_emojiSelectPopoverTitle__3aqqx",emojiSelectPopoverGroups:"Emoji_emojiSelectPopoverGroups__INXLB",emojiSelectPopoverGroup:"Emoji_emojiSelectPopoverGroup__PznAg",emojiSelectPopoverGroupTitle:"Emoji_emojiSelectPopoverGroupTitle__19c7n",emojiSelectPopoverGroupList:"Emoji_emojiSelectPopoverGroupList__1o3D5",emojiSelectPopoverGroupItem:"Emoji_emojiSelectPopoverGroupItem__2JkCZ",emojiSelectPopoverToneSelect:"Emoji_emojiSelectPopoverToneSelect__1AcXa",emojiSelectPopoverToneSelectList:"Emoji_emojiSelectPopoverToneSelectList__3mUh9",emojiSelectPopoverToneSelectItem:"Emoji_emojiSelectPopoverToneSelectItem__3nzrn",emojiSelectPopoverEntry:"Emoji_emojiSelectPopoverEntry__348ax",emojiSelectPopoverEntryFocused:"Emoji_emojiSelectPopoverEntryFocused__2W-FC",emojiSelectPopoverEntryIcon:"Emoji_emojiSelectPopoverEntryIcon__1J_Kt",emojiSelectPopoverNav:"Emoji_emojiSelectPopoverNav__3B-gB",emojiSelectPopoverNavItem:"Emoji_emojiSelectPopoverNavItem__lFOKY",emojiSelectPopoverNavEntry:"Emoji_emojiSelectPopoverNavEntry__1-ML1",emojiSelectPopoverNavEntryActive:"Emoji_emojiSelectPopoverNavEntryActive__3shbJ",emojiSelectPopoverScrollbar:"Emoji_emojiSelectPopoverScrollbar__t-UwT",emojiSelectPopoverScrollbarThumb:"Emoji_emojiSelectPopoverScrollbarThumb__wR-Ed",emoji:"Emoji_emoji__QPqtu",emojiSuggestionsEntry:"Emoji_emojiSuggestionsEntry__Y72gr",emojiSuggestionsEntryFocused:"Emoji_emojiSuggestionsEntryFocused__2Ybv5",emojiSuggestionsEntryText:"Emoji_emojiSuggestionsEntryText__1IeZE",emojiSuggestionsEntryIcon:"Emoji_emojiSuggestionsEntryIcon__tRyLo",emojiSuggestions:"Emoji_emojiSuggestions__12D_M"}},208:function(e,t,a){e.exports={input:"Link_input__3FV7L",inputInvalid:"Link_inputInvalid__3tV4f",link:"Link_link__2SzqL"}},209:function(e,t,a){e.exports={link:"Linkify_link__11Tlm"}},736:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Mr}));var n=a(14),r=a(34),o=a(7),c=a(228),i=a(0),s=a.n(i),l=a(196),u="chat",d="auth",j="user",b="profile",p="home/latest",m="notifs",h="notifs_count",x="messages",g="widget-toFollow",O="widget-tagToFollow",f="tags",v="/",y="/login",w="/signup",k="/terms",S="/home",C="/explore",N="/notifications",P="/messages/:username",I="/messages",_="/tags/:name",E="/:username",F="/:username/followers",T="/:username/following",z="/posts/:postId",L="/:username/settings",W=a(1),D=function(e){var t=e.children,a=Object(c.a)(e,["children"]),n=Object(l.b)().getQueryData(d);return Object(W.jsx)(r.b,Object(o.a)(Object(o.a)({},a),{},{render:function(e){return n?t:Object(W.jsx)(r.a,{to:{pathname:y,state:{from:e.location}}})}}))},R=a(19),B=a.n(R);function M(e){e&&(B.a.defaults.headers.common.Authorization="Bearer ".concat(e))}var H=a(8),K=a.n(H),Q=a(16),A=a(20),G=a(133),q=a(806),V=a(773),U=a(769),Z=a(419),J=a(114),Y=a(764),X=a(766),$=a(37),ee=a(385),te=function(e){var t=e.title,a=e.description,n=Object($.a)();return Object(W.jsxs)(ee.a,{children:[Object(W.jsx)("html",{lang:"en"}),Object(W.jsxs)("title",{children:[t," | ",a||"Witti"]}),Object(W.jsx)("meta",{name:"theme-color",content:n.palette.primary.main}),Object(W.jsx)("meta",{name:"description",content:a})]})},ae=a(800),ne=a(768),re=Object(Y.a)((function(e){return Object(X.a)({field:{marginTop:e.spacing(2)},button:{marginTop:"3rem",color:e.palette.background.paper}})}));function oe(e){var t=e.formik,a=re(),n=t.values,r=t.isSubmitting,o=t.handleChange,c=t.handleBlur,i=t.handleSubmit;return Object(W.jsxs)("form",{onSubmit:i,children:[Object(W.jsx)(ae.a,{name:"email",label:"Email",type:"text",className:a.field,value:n.email,onChange:o,onBlur:c,fullWidth:!0}),Object(W.jsx)(ae.a,{name:"password",label:"Password",type:"password",className:a.field,value:n.password,onChange:o,onBlur:c,fullWidth:!0}),Object(W.jsx)(ne.a,{type:"submit",color:"primary",variant:"contained",className:a.button,disableElevation:!0,fullWidth:!0,disabled:r,children:"Login"})]})}var ce=a(418);function ie(e){var t=e.size,a=void 0===t?60:t;return Object(W.jsx)(U.a,{to:S,component:n.b,children:Object(W.jsxs)(ce.a,{viewBox:"0 0 192 116",color:"secondary",style:{fontSize:a},children:[Object(W.jsx)("rect",{width:"192",height:"115.5",rx:"57.75",fill:"#14B89C"}),Object(W.jsx)("path",{d:"M69.0234 72.0273L74.7109 49.4141H79.7695L71.1562 79H67.0547L59.8633 56.5781L52.8633 79H48.7617L40.1758 49.4141H45.207L51.0312 71.5625L57.9219 49.4141H61.9961L69.0234 72.0273ZM90.4336 79H85.375V49.4141H90.4336V79ZM84.9648 41.5664C84.9648 40.7461 85.2109 40.0534 85.7031 39.4883C86.2135 38.9232 86.9609 38.6406 87.9453 38.6406C88.9297 38.6406 89.6771 38.9232 90.1875 39.4883C90.6979 40.0534 90.9531 40.7461 90.9531 41.5664C90.9531 42.3867 90.6979 43.0703 90.1875 43.6172C89.6771 44.1641 88.9297 44.4375 87.9453 44.4375C86.9609 44.4375 86.2135 44.1641 85.7031 43.6172C85.2109 43.0703 84.9648 42.3867 84.9648 41.5664ZM105.418 42.25V49.4141H110.941V53.3242H105.418V71.6719C105.418 72.8568 105.664 73.75 106.156 74.3516C106.648 74.9349 107.487 75.2266 108.672 75.2266C109.255 75.2266 110.057 75.1172 111.078 74.8984V79C109.747 79.3646 108.453 79.5469 107.195 79.5469C104.935 79.5469 103.23 78.8633 102.082 77.4961C100.934 76.1289 100.359 74.1875 100.359 71.6719V53.3242H94.9727V49.4141H100.359V42.25H105.418ZM123.738 42.25V49.4141H129.262V53.3242H123.738V71.6719C123.738 72.8568 123.984 73.75 124.477 74.3516C124.969 74.9349 125.807 75.2266 126.992 75.2266C127.576 75.2266 128.378 75.1172 129.398 74.8984V79C128.068 79.3646 126.773 79.5469 125.516 79.5469C123.255 79.5469 121.551 78.8633 120.402 77.4961C119.254 76.1289 118.68 74.1875 118.68 71.6719V53.3242H113.293V49.4141H118.68V42.25H123.738ZM140.691 79H135.633V49.4141H140.691V79ZM135.223 41.5664C135.223 40.7461 135.469 40.0534 135.961 39.4883C136.471 38.9232 137.219 38.6406 138.203 38.6406C139.188 38.6406 139.935 38.9232 140.445 39.4883C140.956 40.0534 141.211 40.7461 141.211 41.5664C141.211 42.3867 140.956 43.0703 140.445 43.6172C139.935 44.1641 139.188 44.4375 138.203 44.4375C137.219 44.4375 136.471 44.1641 135.961 43.6172C135.469 43.0703 135.223 42.3867 135.223 41.5664Z",fill:"white"})]})})}var se=a(771),le=Object(Y.a)((function(e){return Object(X.a)({bottom:{color:e.palette.common.white},top:{color:e.palette.primary.main,animationDuration:"500ms",position:"absolute",left:0},circle:{strokeLinecap:"round"}})}));function ue(e){var t=le();return Object(W.jsxs)(q.a,{py:4,position:"relative",display:"inherit",justifyContent:"center",alignItems:"center",children:[Object(W.jsx)(se.a,Object(o.a)(Object(o.a)({variant:"determinate",className:t.bottom,size:e.size||24,thickness:4},e),{},{value:100})),Object(W.jsx)(se.a,Object(o.a)({variant:"indeterminate",disableShrink:!0,className:t.top,classes:{circle:t.circle},size:e.size||24,thickness:4},e))]})}var de=function(e){return Object(W.jsx)(q.a,Object(o.a)(Object(o.a)({display:"flex",alignItems:"center",justifyContent:"center"},e),{},{children:Object(W.jsx)(ue,{size:e.size})}))},je=s.a.forwardRef((function(e,t){var a=Object(r.h)().pathname,n=e.iconSize,c=e.resource,i=e.hasNextPage,s=e.isFetchingNextPage,l=e.fetchNextPage;return Object(W.jsx)(W.Fragment,{children:s?Object(W.jsx)(ne.a,Object(o.a)(Object(o.a)({endIcon:Object(W.jsx)(ue,{size:n}),disabled:s},e),{},{children:"Loading more..."})):i?Object(W.jsxs)(ne.a,Object(o.a)(Object(o.a)({ref:t,onClick:function(){return l()}},e),{},{children:["Load more ",c]})):a.includes("messages")?Object(W.jsx)(ne.a,Object(o.a)({disabled:!i},e)):Object(W.jsxs)(ne.a,Object(o.a)(Object(o.a)({disabled:!i},e),{},{children:["No more ",c]}))})})),be=a(807),pe=a(772),me=a(808);function he(){var e=localStorage.getItem("token");return e&&M(e),Object(pe.a)(d,Object(Q.a)(K.a.mark((function e(){var t,a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get("/users/auth");case 2:return t=e.sent,a=t.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)}))),{enabled:!!e})}function xe(e){var t=localStorage.getItem("token");return t&&M(t),Object(pe.a)([j,e],Object(Q.a)(K.a.mark((function t(){var a,n;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.a.get("/profile/".concat(e));case 2:return a=t.sent,n=a.data,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)}))))}function ge(){var e=Object(l.b)(),t=localStorage.getItem("token");return t&&M(t),Object(be.a)(function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.values,console.log(a.dob),e.next=4,B.a.put("/profile",Object(o.a)(Object(o.a)({},a),{},{dob:new Date(a.dob)}));case 4:return n=e.sent,e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onMutate:function(t){var a=t.cacheKey,n=t.values;return e.setQueryData(a,(function(e){return Object(o.a)(Object(o.a)({},e),{},{name:n.name,username:n.username,bio:n.bio,dob:n.dob,avatar:n.avatar})}))},onError:function(e){console.log(e)}})}function Oe(e){return localStorage.token&&M(localStorage.token),Object(me.a)(e,function(){var t=Object(Q.a)(K.a.mark((function t(a){var n,r,o;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.pageParam,r=void 0===n?0:n,t.next=3,B.a.get("".concat(e,"?cursor=").concat(r));case 3:return o=t.sent,t.abrupt("return",o.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{getNextPageParam:function(e){var t;return null!==(t=e.nextCursor)&&void 0!==t&&t}})}function fe(){localStorage.token&&M(localStorage.token);var e=Object(l.b)();return Object(be.a)(function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.user_id,n=t.follow,e.next=3,B.a.post("/users/".concat(a,"/").concat(n?"unfollow":"follow"));case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onMutate:function(t){var a=t.user_id,n=t.post_id,r=t.pageIndex,c=t.key,i=t.follow,s=t.widget;return void 0!==r&&"number"===typeof r?n?e.setQueryData(c,(function(e){var t=null===e||void 0===e?void 0:e.pages[r];if(t){var a=null===t||void 0===t?void 0:t.data.map((function(e){return e.id===n?Object(o.a)(Object(o.a)({},e),{},{author:Object(o.a)(Object(o.a)({},e.author),{},{isFollowing:!i})}):e}));null===e||void 0===e||e.pages.splice(r,1,{data:a,nextCursor:null===t||void 0===t?void 0:t.nextCursor})}return e})):e.setQueryData(c,(function(e){var t=null===e||void 0===e?void 0:e.pages[r];if(t){var n=null===t||void 0===t?void 0:t.data.map((function(e){return e.id===a?Object(o.a)(Object(o.a)({},e),{},{isFollowing:!i}):e}));null===e||void 0===e||e.pages.splice(r,1,{data:n,nextCursor:null===t||void 0===t?void 0:t.nextCursor})}return e})):n?e.setQueryData(c,(function(e){return Object(o.a)(Object(o.a)({},e),{},{author:Object(o.a)(Object(o.a)({},null===e||void 0===e?void 0:e.author),{},{isFollowing:!i})})})):s?e.setQueryData(c,(function(e){return null===e||void 0===e?void 0:e.map((function(e){return e.id===a?Object(o.a)(Object(o.a)({},e),{},{isFollowing:!i}):e}))})):e.setQueryData(c,(function(e){return Object(o.a)(Object(o.a)({},e),{},{isFollowing:!i})}))},onError:function(e){console.log("Error: ",e.message)},onSettled:function(t,a,n){var r=n.key;return e.invalidateQueries(r)}})}function ve(){return localStorage.token&&M(localStorage.token),Object(me.a)(O,function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.pageParam,n=void 0===a?0:a,e.next=3,B.a.get("/tags/to-follow?cursor=".concat(n));case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{getNextPageParam:function(e){var t;return null!==(t=e.nextCursor)&&void 0!==t&&t}})}function ye(){localStorage.token&&M(localStorage.token);var e=Object(l.b)();return Object(be.a)(function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.tag_id,e.next=3,B.a.post("/tags/".concat(a,"/follow"));case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onMutate:function(t){var a=t.tag_id,n=t.pageIndex,r=t.key;e.setQueryData(r,(function(e){var t=null===e||void 0===e?void 0:e.pages[n];if(t){var r=null===t||void 0===t?void 0:t.data.map((function(e){return e.id===a&&(e.isFollowing?e.isFollowing=!1:e.isFollowing=!0),e}));null===e||void 0===e||e.pages.splice(n,1,{data:r,nextCursor:null===t||void 0===t?void 0:t.nextCursor})}return e}))},onError:function(e){var t;console.error("Error: ",null===(t=e.response)||void 0===t?void 0:t.data)},onSettled:function(){return e.invalidateQueries()}})}var we=Object(Y.a)((function(e){return Object(X.a)({wrapper:{height:"100%",width:"100%",position:"relative","&:after":{content:'""',position:"fixed",width:"100%",height:"70vh",zIndex:-1,top:0,transformOrigin:"left top",transform:"skewY(-15deg)",backgroundColor:e.palette.primary.main}},paper:Object(A.a)({width:"100%",padding:e.spacing(3,5)},e.breakpoints.up("sm"),{maxWidth:"500px",boxShadow:e.shadows[3],padding:e.spacing(5,10),margin:e.spacing(4,"auto")}),field:{marginTop:e.spacing(2)},button:{marginTop:"3rem",color:e.palette.background.paper}})}));var ke=Object(r.j)((function(e){var t,a=Object($.a)(),o=we(),c=Object(r.g)(),s=he(),l=s.data,u=s.status,d=Object(be.a)(function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.post("/users/login",JSON.stringify(t));case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onSuccess:function(e){var t=e.token;return localStorage.setItem("token",t)},onError:function(e){var t;return console.log(null===(t=e.response)||void 0===t?void 0:t.data)}}),j=d.mutate,b=d.isError,p=d.error,m=l&&localStorage.getItem("token"),h=(e.location.state||{from:{pathname:v}}).from;return console.log(m),Object(i.useEffect)((function(){m&&c.replace(h)}),[h,c,m]),m?Object(W.jsx)(de,{height:"100vh"}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(te,{title:"Login"}),"loading"===u?Object(W.jsx)(de,{height:"100vh"}):Object(W.jsx)("div",{className:o.wrapper,children:Object(W.jsx)(V.a,{container:!0,alignItems:"center",justify:"center",style:{minHeight:"100vh"},children:Object(W.jsx)(V.a,{item:!0,xs:12,sm:8,md:6,component:"main",children:Object(W.jsxs)(Z.a,{color:"primary",elevation:0,className:o.paper,children:[Object(W.jsx)(q.a,{textAlign:"center",children:Object(W.jsx)(ie,{})}),Object(W.jsx)(J.a,{component:"p",variant:"h6",align:"center",noWrap:!0,children:"Log in to your account."}),b&&Object(W.jsx)(q.a,{my:2,p:1,bgcolor:a.palette.grey[100],children:Object(W.jsx)(J.a,{color:"error",variant:"subtitle1",align:"center",children:null===p||void 0===p||null===(t=p.response)||void 0===t?void 0:t.data.message})}),Object(W.jsx)(G.a,{initialValues:{email:"",password:""},onSubmit:function(){var e=Object(Q.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:function(e){return Object(W.jsx)(oe,{formik:e})}}),Object(W.jsxs)(J.a,{variant:"body2",style:{marginTop:"2rem"},gutterBottom:!0,children:["Don't have an account?",Object(W.jsx)(U.a,{component:n.b,to:w,color:"primary",children:Object(W.jsx)("strong",{children:" Sign up here."})})]})]})})})})]})})),Se=a(61),Ce=a(12),Ne=a(414),Pe=a(47),Ie=a(799),_e=Object(Y.a)((function(e){return Object(X.a)({field:{marginTop:e.spacing(2)},button:{marginTop:"3rem",color:e.palette.background.paper}})}));function Ee(e){var t=e.formik,a=Object(i.useState)(null),n=Object(Ce.a)(a,2),r=n[0],o=n[1],c=_e(),s=t.values,l=t.touched,u=t.errors,d=t.handleChange,j=t.handleBlur;return Object(W.jsxs)("form",{children:[Object(W.jsx)(ae.a,{name:"name",label:"Your name",type:"text",className:c.field,value:s.name,onChange:d,onBlur:j,helperText:(null===u||void 0===u?void 0:u.name)&&(null===l||void 0===l?void 0:l.name)&&(null===u||void 0===u?void 0:u.name),error:!(!(null===u||void 0===u?void 0:u.name)||!(null===l||void 0===l?void 0:l.name)),fullWidth:!0}),Object(W.jsx)(ae.a,{name:"username",label:"Username",type:"text",className:c.field,value:s.username,onChange:d,onBlur:j,helperText:(null===u||void 0===u?void 0:u.username)&&(null===l||void 0===l?void 0:l.username)&&(null===u||void 0===u?void 0:u.username),error:!(!(null===u||void 0===u?void 0:u.username)||!(null===l||void 0===l?void 0:l.username)),fullWidth:!0}),Object(W.jsx)(Pe.a,{utils:Ne.a,children:Object(W.jsx)(Ie.a,{fullWidth:!0,name:"dob",label:"Birthday",format:"MM/dd",className:c.field,value:r,onBlur:j,onChange:function(e){return o(e)},helperText:(null===u||void 0===u?void 0:u.dob)&&(null===l||void 0===l?void 0:l.dob)&&(null===u||void 0===u?void 0:u.dob)})}),Object(W.jsx)(ae.a,{multiline:!0,name:"bio",label:"About you",type:"bio",rows:4,className:c.field,value:s.bio,onChange:d,onBlur:j,helperText:(null===u||void 0===u?void 0:u.bio)&&(null===l||void 0===l?void 0:l.bio)&&(null===u||void 0===u?void 0:u.bio),error:!(!(null===l||void 0===l?void 0:l.bio)||!(null===u||void 0===u?void 0:u.bio)),fullWidth:!0})]})}var Fe=Object(Y.a)((function(e){return Object(X.a)({field:{marginTop:e.spacing(2)},button:{marginTop:"3rem",color:e.palette.background.paper}})}));function Te(e){var t=e.formik,a=Fe(),n=t.values,r=t.errors,o=t.touched,c=t.isSubmitting,i=t.handleChange,s=t.handleBlur,l=t.handleSubmit;return Object(W.jsxs)("form",{onSubmit:l,children:[Object(W.jsx)(ae.a,{name:"name",label:"Your Name",type:"name",className:a.field,value:n.name,onChange:i,onBlur:s,helperText:r.name&&o.name&&r.name,error:!(!o.name||!r.name),fullWidth:!0}),Object(W.jsx)(ae.a,{name:"username",label:"Username",type:"username",className:a.field,value:n.username,onChange:i,onBlur:s,helperText:r.username&&o.username&&r.username,error:!(!o.username||!r.username),fullWidth:!0}),Object(W.jsx)(ae.a,{name:"email",label:"Email",type:"email",className:a.field,value:n.email,onChange:i,onBlur:s,helperText:r.email&&o.email&&r.email,error:!(!o.email||!r.email),fullWidth:!0}),Object(W.jsx)(ae.a,{name:"password",label:"Password",type:"password",className:a.field,value:n.password,onChange:i,onBlur:s,helperText:r.password&&o.password&&r.password,error:!(!o.password||!r.password),fullWidth:!0}),Object(W.jsx)(ae.a,{name:"password2",label:"Confirm Your Password",type:"password",className:a.field,value:n.password2,onChange:i,onBlur:s,helperText:r.password2&&o.password2&&r.password2,error:!(!o.password2||!r.password2),fullWidth:!0}),Object(W.jsx)(ne.a,{type:"submit",color:"primary",variant:"contained",className:a.button,disabled:c,disableElevation:!0,fullWidth:!0,children:"Sign Up"})]})}function ze(e){var t=Object(i.useState)(!1),a=Object(Ce.a)(t,2),n=a[0],r=a[1],o=e.errors,c=e.value,s=e.handleChange,l=e.handleSubmit;return Object(W.jsx)("form",{style:{width:"100%"},onSubmit:l,children:Object(W.jsx)(ae.a,{fullWidth:!0,label:"Tags",name:"tag",placeholder:"Enter tag name and press enter",type:"text",color:"primary",value:c,onChange:s,error:n&&o&&o.length>0,onFocus:function(){return r(!0)},onBlur:function(){return r(!1)},helperText:n&&o?1===o.length?o[0]:o.join(", "):"Don't forget to tag your post, it increases it's visibilty"})})}var Le=a(35),We=a(809);a(391);function De(e,t){return localStorage.token&&M(localStorage.token),Object(me.a)(e,function(){var e=Object(Q.a)(K.a.mark((function e(a){var n,r,o;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.pageParam,r=void 0===n?0:n,e.next=3,B.a.get("".concat(t,"&cursor=").concat(r));case 3:return o=e.sent,e.abrupt("return",o.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{getNextPageParam:function(e){var t;return null!==(t=e.nextCursor)&&void 0!==t&&t}})}function Re(){localStorage.token&&M(localStorage.token);var e=Object(l.b)();return Object(be.a)(function(){var e=Object(Q.a)(K.a.mark((function e(t){var a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.delete("/posts/".concat(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onError:function(e){var t;console.log("Error: ",null===(t=e.response)||void 0===t?void 0:t.data.message)},onSuccess:function(){return e.invalidateQueries()}})}function Be(){return localStorage.token&&M(localStorage.token),Object(pe.a)("all-tags",Object(Q.a)(K.a.mark((function e(){var t;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get("/tags/all-tags");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))))}var Me=function(){return Se.c().max(32,"Must be 32 characters or less").min(2,"Must be at least 2 characters").required("Required")},He=function(){return Se.c().max(32,"Must be 32 characters or less").min(3,"Must be 3 characters or more").matches(/^[a-zA-Z0-9_]*$/,{message:"Must contain only valid characters (a-z, A-Z, 0-9, and _)",excludeEmptyString:!0}).required("Username is required").test({name:"uniqueUsername",exclusive:!0,message:"A user with that username already exists",test:function(){var e=Object(Q.a)(K.a.mark((function e(t){var a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.post("".concat("https://witti.herokuapp.com/api","/profile/check-username"),{username:t});case 2:return a=e.sent,e.abrupt("return",a.data.res);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})},Ke=Object(Y.a)((function(e){return Object(X.a)({wrapper:{height:"100%",width:"100%",position:"relative","&:after":{content:'""',position:"fixed",width:"100%",height:"70vh",zIndex:-1,top:0,transformOrigin:"left top",transform:"skewY(-15deg)",backgroundColor:e.palette.primary.main}},paper:Object(A.a)({width:"100%",padding:e.spacing(3,5)},e.breakpoints.up("sm"),{maxWidth:"500px",boxShadow:e.shadows[3],padding:e.spacing(5,10),margin:e.spacing(4,"auto")}),field:{marginTop:e.spacing(2)},button:{marginTop:"3rem",color:e.palette.background.paper}})}));function Qe(){var e,t=Object(r.g)(),a=Object($.a)(),o=Ke(),c=Object(be.a)(function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n,r,o,c,i;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.email,n=t.password,r=t.name,o=t.username,e.next=3,B.a.post("/users/register",JSON.stringify({email:a,password:n,name:r,username:o}));case 3:return c=e.sent,i=c.data,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onSuccess:function(e){var t=e.token;return localStorage.setItem("token",t)},onError:function(e){var t;return console.log(null===(t=e.response)||void 0===t?void 0:t.data)}}),s=c.mutate,l=c.error,u=c.isError,d=he(),j=d.data,b=d.status,p=j&&localStorage.getItem("token");return Object(i.useEffect)((function(){p&&t.replace(C)}),[t,p]),p?Object(W.jsx)(de,{height:"100vh"}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(te,{title:"Sign up"}),"loading"===b?Object(W.jsx)(de,{height:"100vh"}):Object(W.jsx)("div",{className:o.wrapper,children:Object(W.jsx)(V.a,{container:!0,alignItems:"center",justify:"center",children:Object(W.jsx)(V.a,{item:!0,xs:12,sm:8,md:6,component:"main",children:Object(W.jsxs)(Z.a,{color:"primary",elevation:0,className:o.paper,children:[Object(W.jsx)(q.a,{textAlign:"center",children:Object(W.jsx)(ie,{})}),Object(W.jsx)(J.a,{component:"p",variant:"h6",align:"center",className:o.field,noWrap:!0,children:"Create your account."}),u&&Object(W.jsx)(q.a,{my:2,p:1,bgcolor:a.palette.grey[100],children:Object(W.jsx)(J.a,{color:"error",variant:"subtitle1",align:"center",children:null===l||void 0===l||null===(e=l.response)||void 0===e?void 0:e.data.message})}),Object(W.jsx)(G.a,{initialValues:{name:"",username:"",email:"",password:"",password2:""},validateOnChange:!1,validationSchema:Se.a({name:Me(),username:He(),email:Se.c().email("Invalid email address").required("Email is required").test({name:"uniqueEmail",exclusive:!0,message:"A user with that email already exists",test:function(){var e=Object(Q.a)(K.a.mark((function e(t){var a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.post("".concat("https://witti.herokuapp.com/api","/users/check-email"),{email:t});case 2:return a=e.sent,e.abrupt("return",a.data.res);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),password:Se.c().min(8,"Must be 8 characters or more").required("Password is Required"),password2:Se.c().required("You need to confirm your password").nullable().oneOf([Se.b("password"),null],"Both password fields must match")}),onSubmit:function(){var e=Object(Q.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:function(e){return Object(W.jsx)(Te,{formik:e})}}),Object(W.jsxs)(J.a,{variant:"body2",style:{marginTop:"2rem"},gutterBottom:!0,children:["Already have an account?",Object(W.jsx)(U.a,{component:n.b,to:y,color:"primary",children:Object(W.jsx)("strong",{children:" Login here."})})]}),Object(W.jsxs)(J.a,{variant:"body2",paragraph:!0,children:["By clicking the sign up button, you agree to our",Object(W.jsx)(U.a,{component:n.b,to:k,color:"primary",children:" terms"})]})]})})})})]})}var Ae=a(780),Ge=a(781),qe=a(392),Ve=a.n(qe),Ue=a(778),Ze=a(393),Je=a(779),Ye=a.p+"static/media/hero.60b9fde1.jpg",Xe=a(13),$e=a(225),et=a(810),tt=Object(Y.a)((function(e){return Object(X.a)({embed:{display:"flex",borderRadius:8,padding:e.spacing(1),marginBottom:e.spacing(1),backgroundColor:e.palette.grey[100],border:"1px solid ".concat(e.palette.grey[400])}})}));function at(e){var t=e.post,a=tt();return Object(W.jsxs)(U.a,{underline:"none",color:"textPrimary",to:"/posts/".concat(t.id),component:n.b,className:a.embed,children:[Object(W.jsx)(et.a,{"aria-label":"avatar",src:t.author.profile.name,alt:t.author.profile.name,style:{width:"24px",height:"24px"}}),Object(W.jsxs)(q.a,{width:"100%",mx:1,children:[Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",mb:1,children:[Object(W.jsx)(J.a,{color:"textPrimary",variant:"subtitle2",component:"h6",noWrap:!0,children:Object(W.jsx)("small",{children:t.author.profile.name})}),Object(W.jsx)(J.a,{color:"textSecondary",variant:"subtitle2",component:"h6",noWrap:!0,style:{marginLeft:8},children:Object(W.jsx)("small",{children:"@".concat(t.author.profile.username)})})]}),t.body.match('(^{"blocks":)')?Object(W.jsx)(J.a,{children:Object(W.jsx)("small",{dangerouslySetInnerHTML:{__html:Object($e.a)(Object(Xe.convertFromRaw)(JSON.parse(t.body)))}})}):Object(W.jsx)(J.a,{style:{lineHeight:1.2},children:Object(W.jsx)("small",{children:t.body})})]})]})}function nt(e){var t=e.post,a=e.postPage,o=Object(r.h)().pathname;return Object(W.jsxs)(W.Fragment,{children:[t.parent?Object(W.jsx)(rt,{post:t.body}):a?Object(W.jsx)(rt,{post:t.body,postPage:!0}):Object(W.jsx)(U.a,{underline:"none",to:"/posts/".concat(t.id),component:n.b,children:Object(W.jsx)(rt,{post:t.body})}),t.parent&&!o.split("/").includes("posts")&&Object(W.jsx)(at,{post:t.parent}),Object(W.jsx)(q.a,{flexWrap:"wrap",display:"flex",alignItems:"center",mb:2,children:null===t||void 0===t?void 0:t.tags.map((function(e){return Object(W.jsx)(U.a,{color:"textSecondary",to:"/tags/".concat(e.name),component:n.b,style:{marginRight:8},children:"#".concat(e.name)},e.id)}))})]})}function rt(e){var t=e.post,a=e.postPage,n=e.dark;return t.match('({"blocks":)')?Object(W.jsx)(J.a,{color:n?"secondary":"textPrimary",component:"p",gutterBottom:!0,variant:a?"h6":"subtitle1",dangerouslySetInnerHTML:{__html:Object($e.a)(Object(Xe.convertFromRaw)(JSON.parse(t).body),{inlineStyles:{ITALIC:{style:{fontSize:14}}},entityStyleFn:function(e){if("link"===e.get("type").toLowerCase()){var t=e.getData();return{element:"a",attributes:{href:t.url,rel:t.rel},style:{color:"#12aac9",textDecoration:"none"}}}}})}}):Object(W.jsx)(J.a,{color:n?"secondary":"textPrimary",component:"p",gutterBottom:!0,variant:a?"h6":"subtitle1",children:t})}function ot(e){return Object(W.jsx)(ce.a,Object(o.a)(Object(o.a)({},e),{},{children:Object(W.jsx)("path",{d:"m102.5 100.75h-56.85l11.761-8.387a1.744 1.744 0 0 0 .711-1.141l1.613-9.843 2.932-5.058 1.267.734a1.75 1.75 0 0 0 2.446-.737l18.243-36.818.953.522-7.737 17.778a1.749 1.749 0 0 0 .906 2.3 1.727 1.727 0 0 0 .7.146 1.749 1.749 0 0 0 1.603-1.046l8.375-19.25a1.749 1.749 0 0 0 -.765-2.233l-2.48-1.358 1.61-3.25a6.4 6.4 0 0 0 -11.046-6.4l-26.858 40.046a1.749 1.749 0 0 0 .575 2.488l1.267.735-2.932 5.057-7.74 6.291a1.748 1.748 0 0 0 -.638 1.185l-1.816 18.239h-13.1a1.75 1.75 0 0 0 0 3.5h77a1.75 1.75 0 0 0 0-3.5zm-22.852-72.1a2.9 2.9 0 0 1 5 2.9l-20.575 41.54-10.242-5.938zm-20.008 45.915-2.216 3.822-4.886-2.832 2.216-3.822zm-9.327 3.746 5.826 3.376-1.353 8.25-9.032 6.44 4.84-8.349a1.75 1.75 0 0 0 -3.028-1.756l-4.84 8.351 1.1-11.04z"})}))}function ct(e){return Object(W.jsxs)(ce.a,Object(o.a)(Object(o.a)({},e),{},{children:[Object(W.jsx)("path",{d:"M0.1 352.5c0 66.8 54.1 120.9 120.9 120.9 66.8 0 120.9-54.1 120.9-120.9s-54.1-120.9-120.9-120.9c-13.7 0-26.9 2.4-39.2 6.6C109.1 82.1 230.8-18.5 118 64.3 -7.1 156.2 0 348.8 0.1 352.4 0.1 352.4 0.1 352.5 0.1 352.5z"}),Object(W.jsx)("path",{d:"M266.2 352.5c0 66.8 54.1 120.9 120.9 120.9s120.9-54.1 120.9-120.9S453.9 231.6 387.1 231.6c-13.7 0-26.9 2.4-39.2 6.6C375.2 82.1 496.9-18.5 384 64.3 258.9 156.2 266 348.8 266.2 352.4 266.2 352.4 266.2 352.5 266.2 352.5z"})]}))}var it=Object(Y.a)((function(e){return Object(X.a)({root:{position:"relative",height:"100vh",justifyContent:"center",display:"flex",flexDirection:"column","&:after":{top:0,left:0,content:'""',zIndex:-1,width:"100%",height:"100vh",display:"block",position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.7)"}},imgContainer:{width:"100%",height:"100vh",position:"absolute",zIndex:-1,top:0,left:0},image:{width:"100%",height:"100%"},margin:Object(A.a)({},e.breakpoints.up("sm"),{margin:e.spacing(0,1)}),main:{display:"flex",justifyContent:"center",flexDirection:"column"},sample:{width:"100%",minHeight:120,display:"flex",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.1)",padding:e.spacing(3,0)}})}));function st(){var e=it(),t=Object($.a)(),a=Object(Je.a)(t.breakpoints.down("xs")),o=Object(r.g)(),c=he(),s=c.data,l=c.status,u=s&&localStorage.getItem("token"),d=Object(pe.a)("featured-posts",Object(Q.a)(K.a.mark((function e(){var t;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get("/posts/featured");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))),j=d.data,b=d.isLoading,p=d.isError;return Object(i.useEffect)((function(){u&&o.replace(S)}),[o,u]),u?Object(W.jsx)(de,{height:"100vh"}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(te,{title:"Landing"}),"loading"===l?Object(W.jsx)(de,{height:"100vh"}):Object(W.jsxs)("div",{className:e.root,children:[Object(W.jsx)("div",{className:e.imgContainer,children:Object(W.jsx)("img",{src:Ye,alt:"Logo",className:e.image})}),Object(W.jsx)(Ae.a,{color:"transparent",elevation:0,children:Object(W.jsx)(Ge.a,{maxWidth:"md",children:Object(W.jsxs)(Ue.a,{component:"nav",disableGutters:!0,style:{justifyContent:"space-between"},children:[Object(W.jsx)(ie,{}),Object(W.jsxs)("div",{children:[Object(W.jsx)(ne.a,{variant:"outlined",color:"secondary",component:n.b,to:w,className:e.margin,children:"Sign up"}),Object(W.jsx)(ne.a,{color:"secondary",component:n.b,to:y,className:e.margin,children:"Login"})]})]})})}),Object(W.jsxs)(q.a,{height:400,component:"main",display:"flex",flexDirection:"column",justifyContent:"space-between",children:[Object(W.jsxs)(Ge.a,{maxWidth:"sm",className:e.main,children:[Object(W.jsx)(J.a,{align:"center",variant:a?"h4":"h3",component:"h1",color:"secondary",gutterBottom:!0,children:"Want to see something funny?"}),Object(W.jsx)(J.a,{component:"h6",align:"center",color:"secondary",paragraph:!0,children:"Join in the fun and share your funny moments."}),Object(W.jsx)(ne.a,{size:"large",variant:"outlined",color:"primary",component:n.b,to:w,style:{margin:"auto"},children:"Join for free."})]}),Object(W.jsx)("section",{className:e.sample,children:Object(W.jsxs)(Ge.a,{maxWidth:"sm",children:[b&&Object(W.jsx)(de,{}),p&&Object(W.jsx)(J.a,{component:"p",align:"center",children:"An error occured"}),j&&Object(W.jsx)(ut,{posts:j})]})})]})]})]})}var lt=Object(Ze.autoPlay)(Ve.a);function ut(e){var t=e.posts,a=s.a.useState(0),n=Object(Ce.a)(a,2),r=n[0],o=n[1],c=Object($.a)();return Object(W.jsx)(lt,{enableMouseEvents:!0,axis:"rtl"===c.direction?"x-reverse":"x",index:r,onChangeIndex:function(e){o(e)},interval:7e3,children:t.map((function(e){return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(J.a,{color:"secondary",component:"p",align:"center",paragraph:!0,style:{padding:c.spacing(0,2)},children:[Object(W.jsx)(ce.a,{component:ct,viewBox:"0 0 508 508",color:"secondary",fontSize:"small",style:{marginRight:c.spacing(2)}}),Object(W.jsx)(rt,{post:e.body,dark:!0})]}),Object(W.jsxs)(J.a,{variant:"subtitle2",align:"right",color:"secondary",component:"p",children:["- ",e.author.profile.username]})]})}))})}var dt=a(801),jt=a(797),bt=a(811),pt=a(803),mt=a(777),ht=a(405),xt=a.n(ht),gt=a(406),Ot=a.n(gt),ft=a(789),vt=a(782),yt=a(767),wt=a(743),kt=a(787),St=a(788),Ct=a(403),Nt=a.n(Ct),Pt=a(401),It=a.n(Pt),_t=a(402),Et=a.n(_t),Ft=a(217),Tt=a.n(Ft),zt=a(219),Lt=a.n(zt),Wt=a(218),Dt=a.n(Wt),Rt=a(774),Bt=a(775),Mt=a(784),Ht=a(398),Kt=a.n(Ht),Qt=a(399),At=a.n(Qt),Gt=a(210),qt=a.n(Gt),Vt=a(216),Ut=a.n(Vt),Zt=a(215),Jt=a.n(Zt),Yt=a(227),Xt=a(211),$t=a(212),ea=a(213),ta=a(214),aa=a(129),na=a(55),ra=(a(188),a(207)),oa=a.n(ra),ca=a(128),ia=a.n(ca),sa=a(208),la=a.n(sa),ua=a(209),da=a.n(ua),ja=a(137),ba=a.n(ja);function pa(e){var t=e.editorState,a=e.limit,n=t.getCurrentContent().getPlainText().length;return Object(W.jsx)(J.a,{variant:"body2",component:"p",color:n>a?"error":"textPrimary",children:n})}var ma=Object(Yt.a)({theme:oa.a,useNativeArt:!0,selectButtonContent:Object(W.jsx)(qt.a,{color:"primary"})}),ha=ma.EmojiSuggestions,xa=ma.EmojiSelect,ga=Object(Xt.a)(),Oa=ga.InlineToolbar,fa=Object($t.a)({target:"_blank",theme:da.a}),va=Object(ea.a)({placeholder:"http://\u2026",theme:la.a}),ya=Object(ta.a)({undoContent:Object(W.jsx)(Jt.a,{color:"primary"}),redoContent:Object(W.jsx)(Ut.a,{color:"primary"}),theme:{undo:ba.a.button,redo:ba.a.button}}),wa=ya.UndoButton,ka=ya.RedoButton,Sa=[ma,ga,va,fa,ya];function Ca(e){var t=e.post_id,a=e.editorRef,c=e.closeEditor,s=e.cacheKey,u=e.tags,d=e.setTags,j=e.selectedTags,b=e.setSelectedTags,p=Object(i.useState)(Xe.EditorState.createEmpty()),m=Object(Ce.a)(p,2),h=m[0],x=m[1],g=Object($.a)(),O=Object(r.g)(),f=he().data,v=function(){localStorage.token&&M(localStorage.token);var e=Object(l.b)();return Object(be.a)(function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.post,e.next=3,B.a.post("/posts",{post:a});case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onMutate:function(t){var a=t.post,n=t.author,r=t.key;e.setQueryData(r,(function(e){return{pageParams:null===e||void 0===e?void 0:e.pageParams,pages:null===e||void 0===e?void 0:e.pages.map((function(e,t){return 0===t?{nextCursor:e.nextCursor,data:[{id:(new Date).getTime(),post:JSON.parse(a).body,comments:0,likes:0,isLiked:!1,parent:null,created_on:new Date(Date.now()).toLocaleDateString("en-gb",{month:"short",day:"numeric"}),author:{id:null===n||void 0===n?void 0:n.id,name:null===n||void 0===n?void 0:n.profile.name,avatar:null===n||void 0===n?void 0:n.profile.avatar,username:null===n||void 0===n?void 0:n.profile.username}}].concat(Object(Le.a)(e.data))}:e}))}}))},onError:function(e){console.log("Error: ",e.message)},onSettled:function(){return e.invalidateQueries()}})}(),y=function(){localStorage.token&&M(localStorage.token);var e=Object(l.b)();return Object(be.a)(function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.post,n=t.post_id,e.next=3,B.a.post("/posts/".concat(n,"/comments"),{post:a});case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onError:function(e){var t;console.error("Error: ",null===(t=e.response)||void 0===t?void 0:t.data)},onSettled:function(){return e.invalidateQueries()}})}(),w=h.getCurrentContent().getPlainText().length,k=h.getCurrentContent().hasText();return console.log(a),Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(q.a,{px:2,pt:2,children:[Object(W.jsxs)(q.a,{display:"flex",justifyContent:"space-between",children:[Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",justifyContent:"flex-end",mb:1,children:[Object(W.jsx)(et.a,{"aria-label":"avatar",src:null===f||void 0===f?void 0:f.profile.avatar,alt:null===f||void 0===f?void 0:f.profile.name}),Object(W.jsxs)(U.a,{underline:"none",to:"/".concat(null===f||void 0===f?void 0:f.profile.username,"/profile"),component:n.b,style:{marginLeft:8},children:[Object(W.jsx)(J.a,{color:"textPrimary",variant:"subtitle2",component:"h6",noWrap:!0,children:null===f||void 0===f?void 0:f.profile.name}),Object(W.jsx)(J.a,{color:"textSecondary",variant:"subtitle2",component:"h6",noWrap:!0,children:"@".concat(null===f||void 0===f?void 0:f.profile.username)})]})]}),Object(W.jsx)(q.a,{display:"flex",alignItems:"center",children:Object(W.jsx)(J.a,{variant:"subtitle2",component:"h6",children:new Date(Date.now()).toLocaleDateString("en-gb",{month:"short",day:"numeric"})})})]}),Object(W.jsx)("div",{className:ia.a.editor,children:Object(W.jsx)(aa.a,{ref:a,editorState:h,onChange:x,plugins:Sa})}),!t&&Object(W.jsx)(q.a,{display:"flex",alignItems:"center",flexWrap:"wrap",children:null===j||void 0===j?void 0:j.map((function(e){return Object(W.jsx)(We.a,{variant:"outlined",size:"small",label:"#".concat(e.name),style:{marginRight:8},onDelete:function(){d([e].concat(Object(Le.a)(u))),b(j.filter((function(t){return t.id!==e.id})))}},e.id)}))}),Object(W.jsx)(vt.a,{})]}),Object(W.jsx)(Oa,{children:function(e){return Object(W.jsxs)(i.Fragment,{children:[Object(W.jsx)(na.a,Object(o.a)({},e)),Object(W.jsx)(na.c,Object(o.a)({},e)),Object(W.jsx)(va.LinkButton,Object(o.a)({},e))]})}}),Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",py:1,children:[Object(W.jsxs)(q.a,{display:"flex",flexGrow:1,children:[Object(W.jsx)(xa,{}),Object(W.jsx)(wa,{}),Object(W.jsx)(ka,{})]}),Object(W.jsx)(pa,{limit:250,editorState:h}),Object(W.jsx)(ne.a,{variant:"contained",color:"primary",disableElevation:!0,onClick:function(){return function(){if(k&&!(w>250)){var e=h.getCurrentContent(),a=JSON.stringify({body:Object(Xe.convertToRaw)(e)});t?(y.mutate({post_id:t,post:a}),c&&c()):(v.mutate({post:a,key:s,author:f}),c&&c(),O.push(S))}}()},style:{textTransform:"capitalize",fontWeight:"bold",margin:g.spacing(0,2),color:g.palette.common.white},disabled:!k||w>250,children:"Post"})]}),Object(W.jsx)(ha,{})]})}var Na=s.a.forwardRef((function(e,t){return Object(W.jsx)(Ca,Object(o.a)({editorRef:t},e))})),Pa=Object(Yt.a)({theme:oa.a,useNativeArt:!0,selectButtonContent:Object(W.jsx)(qt.a,{color:"primary"})}),Ia=Object(Xt.a)(),_a=(Object($t.a)({target:"_blank",theme:da.a}),Object(ea.a)({placeholder:"http://\u2026",theme:la.a}),Object(ta.a)({undoContent:Object(W.jsx)(Jt.a,{color:"primary"}),redoContent:Object(W.jsx)(Ut.a,{color:"primary"}),theme:{undo:ba.a.button,redo:ba.a.button}}));Pa.EmojiSuggestions,Pa.EmojiSelect,Ia.InlineToolbar,_a.UndoButton,_a.RedoButton;Pa.EmojiSuggestions,Pa.EmojiSelect,Ia.InlineToolbar,_a.UndoButton,_a.RedoButton;function Ea(e){var t=Object(i.useState)([]),a=Object(Ce.a)(t,2),n=a[0],r=a[1],o=Object(i.useState)(""),c=Object(Ce.a)(o,2),s=c[0],u=c[1],d=Object(i.useState)([]),j=Object(Ce.a)(d,2),b=j[0],p=j[1],m=Object(i.useState)([]),h=Object(Ce.a)(m,2),x=h[0],g=h[1],O=Be().data,f=function(){localStorage.token&&M(localStorage.token);var e=Object(l.b)();return Object(be.a)(function(){var e=Object(Q.a)(K.a.mark((function e(t){var a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.post("/tags",{name:t});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onMutate:function(t){e.setQueryData("tags",(function(e){return e&&[{id:(new Date).getTime(),name:t}].concat(Object(Le.a)(e))}))},onError:function(e){var t;console.error("Error: ",null===(t=e.response)||void 0===t?void 0:t.data)},onSettled:function(){return e.invalidateQueries("tags")}})}(),v=Kt()(),y=Object(Je.a)(v.breakpoints.down("xs")),w=e.isOpen,k=e.handleClose,S=e.editorRef,C=e.post_id,N=e.cacheKey;Object(i.useEffect)((function(){O&&p(O)}),[O]);var P=function(){var e=Object(Q.a)(K.a.mark((function e(t){var a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),s){e.next=3;break}return e.abrupt("return");case 3:return a=Se.c().max(32,"Must be 32 characters or less").min(2,"Must be at least 2 characters").matches(/^[a-zA-Z0-9_]*$/,{message:"Must contain only valid characters (a-z, A-Z, 0-9)",excludeEmptyString:!0}).test({name:"uniqueTag",exclusive:!0,message:"That tag already exists",test:function(){var e=Object(Q.a)(K.a.mark((function e(t){var a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.post("".concat("https://witti.herokuapp.com/api","/tags/check"),{tag:t});case 2:return a=e.sent,e.abrupt("return",a.data.res);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),e.prev=4,e.next=7,a.validate(s);case 7:f.mutate(s),r([].concat(Object(Le.a)(n),Object(Le.a)(b.filter((function(e){return e.name===s}))))),u(""),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),g(e.t0.errors);case 15:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)(Rt.a,{fullScreen:y,open:w,onClose:k,"aria-labelledby":"add post",children:[Object(W.jsx)(Mt.a,{id:"add post",style:{padding:"8px 0"},children:Object(W.jsx)(mt.a,{onClick:k,color:"primary",children:Object(W.jsx)(At.a,{})})}),Object(W.jsx)(vt.a,{}),Object(W.jsxs)(Bt.a,{style:{padding:0},children:[Object(W.jsx)(Na,{tags:b,setTags:p,selectedTags:n,setSelectedTags:r,cacheKey:N,editorRef:S,post_id:C,closeEditor:k}),Object(W.jsx)(q.a,{display:"flex",alignItems:"center",flexWrap:"wrap",p:2,children:Object(W.jsx)(ze,{errors:x,value:s,handleChange:function(e){return u(e.target.value)},handleSubmit:function(e){return P(e)}})}),Object(W.jsx)(q.a,{display:"flex",alignItems:"center",flexWrap:"wrap",mb:4,px:1,maxHeight:y?120:100,overflow:"auto",children:null===b||void 0===b?void 0:b.filter((function(e){var t=new RegExp("^".concat(s),"gi");return e.name.match(t)})).map((function(e){return Object(W.jsx)(We.a,{size:"small",label:"#".concat(e.name),style:{margin:4},onClick:function(){p(b.filter((function(t){return t.id!==e.id}))),r([].concat(Object(Le.a)(n),[e]))}},e.id)}))})]})]})}var Fa=s.a.forwardRef((function(e,t){return Object(W.jsx)(Ea,Object(o.a)({editorRef:t},e))})),Ta=a(416),za=a(786),La=a(400),Wa=a.n(La),Da=a(785),Ra=a(776);function Ba(e){var t=Object($.a)(),a=Object(Je.a)(t.breakpoints.down("xs")),n=ge().mutate,r=e.isOpen,o=e.user,c=e.handleClose,i={name:(null===o||void 0===o?void 0:o.profile.name)||"",username:(null===o||void 0===o?void 0:o.profile.username)||"",dob:(null===o||void 0===o?void 0:o.profile.dob)||new Date,avatar:(null===o||void 0===o?void 0:o.profile.avatar)||"",bio:(null===o||void 0===o?void 0:o.profile.bio)||""},s=function(e){console.log(e),n({values:e,cacheKey:b}),c()};return Object(W.jsxs)(Rt.a,{fullScreen:a,open:r,onClose:c,"aria-labelledby":"update profile",children:[Object(W.jsx)(Mt.a,{id:"updateProfile",children:"Update your profile."}),Object(W.jsx)(G.a,{initialValues:i,validateOnChange:!1,validationSchema:Se.a({name:Me(),username:He()}),onSubmit:function(){var e=Object(Q.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:function(e){return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Bt.a,{children:Object(W.jsx)(Da.a,{children:Object(W.jsx)(Ee,{formik:e})})}),Object(W.jsxs)(Ra.a,{children:[Object(W.jsx)(ne.a,{onClick:c,children:"Cancel"}),Object(W.jsx)(ne.a,{color:"primary",variant:"contained",style:{color:"white"},onClick:function(){return s(e.values)},children:"update profile"})]})]})}})]})}var Ma=Object(Y.a)((function(e){return Object(X.a)({menuPaper:{minWidth:"240px"},menuDivider:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},menuItem:{minHeight:"32px"},avatar:{marginRight:e.spacing(1)},profile:{display:"flex",alignItems:"center",justifyContent:"flex-start",padding:e.spacing(0,2)},link:{display:"flex",width:"100%",justifyContent:"center",alignContent:"center"},listItemIcon:{color:"inherit",minWidth:0,alignItems:"center",marginRight:e.spacing(2)}})}));function Ha(e){var t=e.user,a=e.anchorEl,o=e.handleClose,c=Object(i.useState)(!1),s=Object(Ce.a)(c,2),u=s[0],j=s[1],b=Ma(),p=Object(r.g)(),m=Object(l.b)();return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("div",{children:Object(W.jsxs)(Ta.a,{id:"user-menu",classes:{paper:b.menuPaper},getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},keepMounted:!0,anchorEl:a,open:Boolean(a),onClose:o,children:[Object(W.jsxs)("div",{className:b.profile,children:[Object(W.jsx)(et.a,{alt:"".concat(null===t||void 0===t?void 0:t.profile.name),src:null===t||void 0===t?void 0:t.profile.avatar,className:b.avatar}),Object(W.jsxs)("div",{children:[Object(W.jsx)(J.a,{variant:"subtitle1",children:"".concat(null===t||void 0===t?void 0:t.profile.name)}),Object(W.jsx)(J.a,{variant:"subtitle2",children:"@"+(null===t||void 0===t?void 0:t.profile.username)})]})]}),Object(W.jsx)(vt.a,{className:b.menuDivider}),Object(W.jsx)(za.a,{onClick:o,classes:{root:b.menuItem},children:Object(W.jsxs)(U.a,{color:"inherit",underline:"none",component:n.b,className:b.link,to:"/".concat(null===t||void 0===t?void 0:t.profile.username),children:[Object(W.jsx)(kt.a,{className:b.listItemIcon,children:Object(W.jsx)(Tt.a,{fontSize:"small"})}),Object(W.jsx)(St.a,{primary:"Profile"})]})}),Object(W.jsxs)(za.a,{classes:{root:b.menuItem},onClick:function(){o(),j(!0)},children:[Object(W.jsx)(kt.a,{className:b.listItemIcon,children:Object(W.jsx)(Wa.a,{fontSize:"small"})}),Object(W.jsx)(St.a,{primary:"Edit Profile"})]}),Object(W.jsx)(za.a,{onClick:o,classes:{root:b.menuItem},children:Object(W.jsxs)(U.a,{color:"inherit",underline:"none",component:n.b,className:b.link,to:"/".concat(null===t||void 0===t?void 0:t.profile.username,"/settings"),children:[Object(W.jsx)(kt.a,{className:b.listItemIcon,children:Object(W.jsx)(Dt.a,{fontSize:"small"})}),Object(W.jsx)(St.a,{primary:"Settings"})]})}),Object(W.jsx)(vt.a,{className:b.menuDivider}),Object(W.jsx)(za.a,{onClick:function(){m.removeQueries(d),localStorage.removeItem("token"),o(),p.push(y)},classes:{root:b.menuItem},children:"Logout"})]})}),Object(W.jsx)(Ba,{isOpen:u,user:t,handleClose:function(){return j(!1)}})]})}var Ka=Object(Y.a)((function(e){return Object(X.a)({menu:Object(A.a)({top:0,left:0,width:240,position:"fixed",textAlign:"center",height:"100%",overflowX:"hidden",padding:e.spacing(0,2),backgroundColor:e.palette.background.paper},e.breakpoints.between("sm","md"),{width:100}),list:{width:"100%"},listItem:Object(A.a)({margin:e.spacing(2,0),transition:e.transitions.create("color"),color:e.palette.grey[800],"&:hover":{color:e.palette.primary.main}},e.breakpoints.up("sm"),{margin:e.spacing(3,0)}),listItemIcon:Object(A.a)({color:"inherit"},e.breakpoints.down("md"),{justifyContent:"center"})})})),Qa=function(e){var t=Ka(),a=Object($.a)(),r=Object(Je.a)(a.breakpoints.down("xs")),c=e.to,i=e.primary,l=e.icon,u=s.a.useMemo((function(){return s.a.forwardRef((function(e,t){return Object(W.jsx)(n.c,Object(o.a)({to:c,ref:t,activeStyle:{color:a.palette.primary.main}},e))}))}),[c,a.palette.primary.main]);return Object(W.jsxs)(wt.a,Object(o.a)(Object(o.a)({className:t.listItem,component:u,disableGutters:!0},e),{},{children:[Object(W.jsx)(kt.a,{className:t.listItemIcon,children:l}),Object(W.jsx)(pt.a,{only:["sm","md"],children:Object(W.jsx)(St.a,{primary:i,primaryTypographyProps:{variant:r?"subtitle1":"h6"}})})]}))};function Aa(e){var t=e.user,a=e.cacheKey,n=Object(i.useState)(null),o=Object(Ce.a)(n,2),c=o[0],u=o[1],j=Object(i.useState)(!1),b=Object(Ce.a)(j,2),p=b[0],m=b[1],x=s.a.useRef(null),g=Object(r.g)(),O=Object(l.b)(),f=(localStorage.token&&M(localStorage.token),Object(pe.a)(h,Object(Q.a)(K.a.mark((function e(){var t;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get("/notifications/count");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{refetchInterval:1e3})).data,v=Ka(),w=Object($.a)(),k=Object(Je.a)(w.breakpoints.down("xs")),P=function(){return u(null)};return Object(i.useEffect)((function(){x.current&&x.current.focus()}),[]),Object(W.jsxs)("section",{className:v.menu,children:[Object(W.jsx)(wt.a,{disableGutters:!0,children:Object(W.jsx)(St.a,{children:Object(W.jsx)(ie,{})})}),Object(W.jsxs)(yt.a,{component:"nav","aria-label":"user menu",className:v.list,children:[Object(W.jsx)(Qa,{primary:"Home",to:S,icon:Object(W.jsx)(It.a,{fontSize:k?"default":"large"})}),Object(W.jsx)(Qa,{primary:"Explore",to:C,icon:Object(W.jsx)(Lt.a,{fontSize:k?"default":"large"})}),Object(W.jsx)(Qa,{primary:"Notifications",to:N,icon:Object(W.jsx)(ft.a,{overlap:"circle",badgeContent:null===f||void 0===f?void 0:f.count,color:"error",children:Object(W.jsx)(Et.a,{fontSize:k?"default":"large"})})}),Object(W.jsx)(Qa,{primary:"Messages",to:I,icon:Object(W.jsx)(Nt.a,{fontSize:k?"default":"large"})}),Object(W.jsxs)(wt.a,{"aria-controls":"add post","aria-haspopup":"true",onClick:function(){P(),m(!0)},className:v.listItem,disableGutters:!0,button:!0,children:[Object(W.jsx)(kt.a,{className:v.listItemIcon,children:Object(W.jsx)(ce.a,{component:ot,viewBox:"0 0 128 128",style:{fontSize:"2.5rem"}})}),Object(W.jsx)(pt.a,{only:["sm","md"],children:Object(W.jsx)(St.a,{primary:"Add Post",primaryTypographyProps:{variant:k?"subtitle1":"h6"}})})]}),Object(W.jsx)(vt.a,{}),Object(W.jsx)(pt.a,{xsDown:!0,children:Object(W.jsxs)(wt.a,{"aria-controls":"profile-menu","aria-haspopup":"true",onClick:function(e){u(e.currentTarget)},style:{margin:w.spacing(3,0)},disableGutters:!0,button:!0,children:[Object(W.jsx)(kt.a,{className:v.listItemIcon,children:Object(W.jsx)(et.a,{alt:null===t||void 0===t?void 0:t.profile.name,src:null===t||void 0===t?void 0:t.profile.avatar})}),Object(W.jsx)(pt.a,{mdDown:!0,children:Object(W.jsx)(St.a,{primary:"".concat(null===t||void 0===t?void 0:t.profile.name),secondary:"@"+(null===t||void 0===t?void 0:t.profile.username),primaryTypographyProps:{variant:"subtitle2",noWrap:!0}})})]})}),Object(W.jsxs)(pt.a,{smUp:!0,children:[Object(W.jsx)(Qa,{primary:"Profile",to:"/".concat(null===t||void 0===t?void 0:t.profile.username,"/profile"),icon:Object(W.jsx)(Tt.a,{})}),Object(W.jsx)(Qa,{primary:"Settings",to:L,icon:Object(W.jsx)(Dt.a,{})}),Object(W.jsx)(vt.a,{}),Object(W.jsx)(wt.a,{onClick:function(){localStorage.removeItem("token"),O.removeQueries(d),g.push(y)},className:v.listItem,button:!0,children:Object(W.jsx)(St.a,{primary:"Logout"})})]})]}),Object(W.jsx)(Ha,{user:t,anchorEl:c,handleClose:P}),Object(W.jsx)(Fa,{editorRef:x,isOpen:p,cacheKey:a,handleClose:function(){return m(!1)}})]})}var Ga=a(404),qa=a.n(Ga),Va=a(804),Ua=a(790),Za=Object(Y.a)((function(e){return Object(X.a)({search:{display:"flex",alignItems:"center",borderRadius:32,margin:e.spacing(0,2),padding:e.spacing(0,2),backgroundColor:e.palette.secondary.light,"&:focus":{backgroundColor:"unset",border:"1px solid ".concat(e.palette.primary.light)}},searchIcon:{display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",marginRight:e.spacing(1)},inputRoot:{width:"100%"},suggestions:Object(A.a)({position:"absolute",maxHeight:400,top:"100%",left:0,right:0,zIndex:1,overflow:"scroll",scrollbarWidth:"none",boxShadow:e.shadows[2],margin:e.spacing(0,2),backgroundColor:e.palette.background.paper,"-ms-overflow-style":"none","&::-webkit-scrollbar":{display:"none"}},e.breakpoints.down("xs"),{width:"100%",margin:"unset"})})}));function Ja(){var e=Object(i.useState)(""),t=Object(Ce.a)(e,2),a=t[0],n=t[1],r=Object(i.useState)(),o=Object(Ce.a)(r,2),c=o[0],s=o[1],l=Object(i.useState)(!1),u=Object(Ce.a)(l,2),d=u[0],j=u[1],b=Object(i.useState)(),p=Object(Ce.a)(b,2),m=p[0],h=p[1],x=Object(i.useState)(!1),g=Object(Ce.a)(x,2),O=g[0],f=g[1],v=Za(),y=Object(Je.a)("(max-width:500px)"),w=function(){var e=Object(Q.a)(K.a.mark((function e(t){var a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),localStorage.token&&M(localStorage.token),e.prev=2,e.next=5,B.a.get("/search?q=".concat(t));case 5:a=e.sent,s(a.data),f(!1),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0),j(!0),h(e.t0);case 15:f(!1);case 16:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),k=Object(i.useCallback)(qa()((function(e){return w(e)}),1e3),[]);return Object(W.jsxs)(q.a,{position:y?"unset":"relative",flexGrow:1,children:[Object(W.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},className:v.search,children:[Object(W.jsx)("div",{className:v.searchIcon,children:Object(W.jsx)(Lt.a,{fontSize:"small"})}),Object(W.jsx)(Va.a,{placeholder:"Search\u2026",inputProps:{"aria-label":"search"},value:a,onChange:function(e){return t=e.target.value,n(t),void k(t);var t},classes:{root:v.inputRoot}})]}),a&&Object(W.jsx)("div",{className:v.suggestions,children:Object(W.jsx)(Ya,{data:c,error:m,isError:d,isLoading:O})})]})}function Ya(e){var t,a=e.data,n=e.error,o=e.isError,c=e.isLoading,i=Object(r.g)();return Object(W.jsx)(yt.a,{disablePadding:!0,children:c?Object(W.jsx)(de,{}):o?Object(W.jsx)(wt.a,{children:Object(W.jsx)(St.a,{primary:null===n||void 0===n||null===(t=n.response)||void 0===t?void 0:t.data.message})}):Object(W.jsxs)(W.Fragment,{children:[null===a||void 0===a?void 0:a.results.tags.map((function(e){return Object(W.jsx)(wt.a,{button:!0,divider:!0,alignItems:"flex-start",onClick:function(){return i.push("/tags/".concat(e.name))},children:Object(W.jsx)(St.a,{primary:"#".concat(e.name)})},e.id)})),null===a||void 0===a?void 0:a.results.users.map((function(e){return Object(W.jsxs)(wt.a,{button:!0,divider:!0,alignItems:"flex-start",onClick:function(){return i.push("/".concat(e.profile.username))},children:[Object(W.jsx)(Ua.a,{children:Object(W.jsx)(et.a,{alt:e.profile.name,src:e.profile.avatar})}),Object(W.jsx)(St.a,{primary:e.profile.name,secondary:e.profile.username})]},e.id)}))]})})}var Xa=Object(Y.a)((function(e){return Object(X.a)({toolbar:{width:"100%",zIndex:1,position:"sticky",top:0,display:"flex",justifyContent:"space-between",padding:e.spacing(0,1),backgroundColor:e.palette.background.paper},drawer:{width:240},avatar:{flexGrow:0,width:e.spacing(4),height:e.spacing(4)},title:{textTransform:"capitalize",lineHeight:"1.4",fontWeight:e.typography.fontWeightBold}})}));function $a(e){var t=Object(i.useState)(!1),a=Object(Ce.a)(t,2),n=a[0],o=a[1],c=Xa(),s=Object(r.g)(),u=Object(l.b)().getQueryData(d),j=e.user,b=e.title,p=e.search,m=e.back,h=e.avatar,x=e.meta,g=function(e){return function(t){("keydown"!==t.type||"Tab"!==t.key&&"Shift"!==t.key)&&o(e)}};return Object(W.jsx)(Ue.a,{classes:{root:c.toolbar},disableGutters:!0,children:Object(W.jsxs)(q.a,{display:"flex",flexGrow:1,position:"relative",children:[m&&Object(W.jsx)(mt.a,{size:"small","aria-label":"go back",onClick:function(){return s.goBack()},children:Object(W.jsx)(xt.a,{color:"primary"})}),h&&Object(W.jsx)(mt.a,{size:"small","aria-label":"menu",onClick:function(){return s.push("/".concat(null===u||void 0===u?void 0:u.profile.username))},children:Object(W.jsx)(et.a,{alt:j?j.profile.avatar:null===u||void 0===u?void 0:u.profile.avatar,src:j?j.profile.avatar:null===u||void 0===u?void 0:u.profile.avatar,className:c.avatar})}),b&&Object(W.jsxs)(q.a,{ml:1,display:"flex",flexDirection:"column",justifyContent:"center",children:[Object(W.jsx)(J.a,{variant:"subtitle1",component:"h3",className:c.title,noWrap:!0,children:b}),x&&Object(W.jsx)(J.a,{color:"textSecondary",noWrap:!0,style:{lineHeight:1},children:Object(W.jsx)("small",{children:x})})]}),p&&Object(W.jsx)(Ja,{}),Object(W.jsxs)(pt.a,{smUp:!0,children:[Object(W.jsx)(mt.a,{size:"small","aria-label":"menu",onClick:g(!0),children:Object(W.jsx)(Ot.a,{})}),Object(W.jsx)(pt.a,{smUp:!0,children:Object(W.jsx)(bt.a,{anchor:"left",open:n,onClose:g(!1),classes:{paper:c.drawer},children:Object(W.jsx)(Aa,{user:u})})})]})]})})}function en(e){var t=e.root,a=e.target,n=e.onIntersect,r=e.threshold,o=void 0===r?0:r,c=e.rootMargin,i=void 0===c?"0px":c,l=e.enabled,u=void 0===l||l;s.a.useEffect((function(){if(u){var e=new IntersectionObserver((function(e){return e.forEach((function(e){return e.isIntersecting&&n()}))}),{root:t&&t.current,rootMargin:i,threshold:o}),r=a&&a.current;if(r)return e.observe(r),function(){e.unobserve(r)}}}),[null===a||void 0===a?void 0:a.current,u])}var tn=Object(Y.a)((function(e){return Object(X.a)({paper:{maxHeight:400,overflow:"scroll",scrollbarWidth:"none","-ms-overflow-style":"none","&::-webkit-scrollbar":{display:"none"}},title:{padding:e.spacing(2)},root:{display:"flex",alignItems:"top",justifyContent:"space-between",padding:e.spacing(1,2),"&:hover span":{visibility:"visible"}},more:{visibility:"hidden",marginLeft:e.spacing(1)},button:{textTransform:"lowercase"}})}));function an(){var e=Object(i.useRef)(null),t=tn(),a=ye(),r=ve(),o=r.data,c=r.isLoading,l=r.isError,u=r.fetchNextPage,d=r.hasNextPage,j=r.isFetchingNextPage;en({enabled:d,target:e,onIntersect:function(){return u()}});var b=function(e){var t=e.followedBy.users,a=e.followedBy.count;return 1===t.length?"Followed by ".concat(t[0].profile.name):2===t.length&&0===a?"Followed by ".concat(t[0].profile.name," and ").concat(t[1].profile.name):"Followed by ".concat(t[0].profile.name,", ").concat(t[1].profile.name," and ").concat(a," others you follow.")};return Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(Z.a,{elevation:0,className:t.paper,children:[Object(W.jsx)(J.a,{className:t.title,children:Object(W.jsx)("strong",{children:"Top Tags to follow"})}),Object(W.jsx)(vt.a,{}),c?Object(W.jsx)(de,{}):l?Object(W.jsx)(J.a,{align:"center",gutterBottom:!0,children:"An error occured, please try again."}):Object(W.jsxs)(W.Fragment,{children:[null===o||void 0===o?void 0:o.pages.map((function(e,r){return Object(W.jsx)(s.a.Fragment,{children:e.data.map((function(e){return Object(W.jsx)(s.a.Fragment,{children:Object(W.jsxs)("div",{className:t.root,children:[Object(W.jsxs)(U.a,{underline:"none",to:"/tags/".concat(e.name),component:n.b,children:[Object(W.jsxs)(J.a,{noWrap:!0,variant:"subtitle1",children:["#",e.name]}),Object(W.jsx)(J.a,{color:"textSecondary",variant:"body2",children:Object(W.jsx)("small",{children:b(e)})})]}),Object(W.jsx)("span",{className:t.more,children:Object(W.jsx)(ne.a,{variant:"outlined",color:"primary",size:"small",className:t.button,onClick:function(){return a.mutate({tag_id:e.id,pageIndex:r,key:O})},children:e.isFollowing?"unfollow":"follow"})})]})},e.id)}))},r)})),Object(W.jsx)(je,{fullWidth:!0,resource:"tags",iconSize:16,ref:e,hasNextPage:d,isFetchingNextPage:j,fetchNextPage:function(){return u()},style:{textTransform:"capitalize"}})]})]})})}var nn=Object(Y.a)((function(e){return Object(X.a)({paper:{top:0,position:"sticky",marginTop:e.spacing(.5)},title:{padding:e.spacing(2)},link:{display:"flex",alignItems:"center",flexGrow:1},avatar:Object(A.a)({},e.breakpoints.down("xs"),{width:32,height:32})})}));function rn(){var e=nn(),t=fe(),a=function(){var e=localStorage.getItem("token");return e&&M(e),Object(pe.a)(g,Object(Q.a)(K.a.mark((function e(){var t,a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get("/users/to-follow");case 2:return t=e.sent,a=t.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)}))))}(),r=a.data,o=a.isLoading,c=a.isError;return Object(W.jsxs)(Z.a,{elevation:0,className:e.paper,children:[Object(W.jsx)(J.a,{variant:"subtitle1",className:e.title,children:Object(W.jsx)("strong",{children:"Who to follow"})}),Object(W.jsx)(vt.a,{}),Object(W.jsx)(yt.a,{children:o?Object(W.jsx)(de,{}):c?Object(W.jsx)(wt.a,{children:Object(W.jsx)(St.a,{primary:"An unexpected error occured, please try again"})}):Object(W.jsx)(W.Fragment,{children:null===r||void 0===r?void 0:r.slice(0,3).map((function(a){return Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",px:1,py:2,children:[Object(W.jsxs)(U.a,{underline:"none",to:"/".concat(a.profile.username),component:n.b,className:e.link,children:[Object(W.jsx)(et.a,{"aria-label":"avatar",src:a.profile.avatar,alt:a.profile.name,className:e.avatar}),Object(W.jsxs)(q.a,{ml:1,children:[Object(W.jsx)(J.a,{noWrap:!0,color:"textPrimary",variant:"body2",children:a.profile.name}),Object(W.jsx)(J.a,{color:"textSecondary",variant:"body2",children:Object(W.jsx)("small",{children:"@".concat(a.profile.username)})})]})]}),Object(W.jsx)(ne.a,{variant:"outlined",color:"primary",size:"small","aria-label":a.isFollowing?"unfollow":"follow",style:{textTransform:"lowercase"},onClick:function(){return t.mutate({user_id:a.id,key:g,widget:!0})},children:a.isFollowing?"following":"follow"})]},a.id)}))})})]})}function on(){var e=Object(r.h)().pathname;return Object(W.jsxs)(W.Fragment,{children:[!e.split("/").includes("explore")&&Object(W.jsx)(an,{}),Object(W.jsx)(rn,{})]})}var cn=Object(Y.a)((function(e){var t;return Object(X.a)({main:(t={},Object(A.a)(t,e.breakpoints.up("sm"),{marginLeft:104}),Object(A.a)(t,e.breakpoints.up("lg"),{marginLeft:244}),t),gridWidget:{paddingLeft:e.spacing(.5)}})}));function sn(e){var t=e.children,a=e.cacheKey,n=e.title,r=e.description,o=cn(),c=he().data;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(te,{title:n,description:r}),Object(W.jsxs)(Ge.a,{maxWidth:"xl",disableGutters:!0,children:[Object(W.jsx)(pt.a,{xsDown:!0,children:Object(W.jsx)(Aa,{user:c,cacheKey:a})}),Object(W.jsx)("div",{className:o.main,children:Object(W.jsxs)(V.a,{container:!0,children:[Object(W.jsx)(V.a,{item:!0,xs:12,md:8,children:t}),Object(W.jsx)(pt.a,{smDown:!0,children:Object(W.jsx)(V.a,{item:!0,xs:12,md:4,className:o.gridWidget,children:Object(W.jsx)(on,{})})})]})})]})]})}var ln=a(408),un=a.n(ln),dn=a(130),jn=a.n(dn),bn=a(220),pn=a.n(bn),mn=a(407),hn=a.n(mn),xn=a(271),gn=a.n(xn);function On(e){var t=Object($.a)(),a=Object(Je.a)(t.breakpoints.down("xs")),n=e.isOpen,r=e.handleClose,o=e.deletePost;return Object(W.jsxs)(Rt.a,{fullScreen:a,open:n,onClose:r,"aria-labelledby":"Delete post",children:[Object(W.jsx)(Mt.a,{id:"Repost",children:"Delete Post"}),Object(W.jsx)(Bt.a,{children:Object(W.jsx)(Da.a,{children:"Are you sure you want to delete this post?"})}),Object(W.jsxs)(Ra.a,{children:[Object(W.jsx)(ne.a,{onClick:function(){o(),r()},style:{color:gn.a[400]},children:"Delete"}),Object(W.jsx)(ne.a,{onClick:r,children:"Cancel"})]})]})}var fn=Object(Y.a)((function(e){return Object(X.a)({menuPaper:{minWidth:"220px",padding:e.spacing(1)},menuDivider:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},menuItem:{minHeight:"32px"},menuProfile:{textAlign:"center",lineHeight:1.2,color:e.palette.text.secondary},link:{display:"flex",width:"100%",justifyContent:"center",alignContent:"center"},listItemIcon:{color:"inherit",minWidth:0,alignItems:"center",marginRight:e.spacing(2)}})}));function vn(e){var t=Object(i.useState)(!1),a=Object(Ce.a)(t,2),n=a[0],r=a[1],o=fn(),c=fe(),s=Object(l.b)().getQueryData(d),u=e.anchorEl,j=e.page,b=e.cacheKey,p=e.post,m=e.closeMenu,h=e.deletePost;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(Ta.a,{keepMounted:!0,anchorEl:u,open:Boolean(u),onClose:m,getContentAnchorEl:null,classes:{paper:o.menuPaper},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[p.author.id!==(null===s||void 0===s?void 0:s.id)&&Object(W.jsxs)(za.a,{onClick:function(){m(),c.mutate({post_id:p.id,user_id:p.author.id,pageIndex:j,follow:p.author.isFollowing,key:b})},classes:{root:o.menuItem},children:[Object(W.jsx)(kt.a,{className:o.listItemIcon,children:Object(W.jsx)(hn.a,{fontSize:"small"})}),Object(W.jsx)(St.a,{primary:"".concat(p.author.isFollowing?"unfollow":"follow"," @").concat(p.author.username),primaryTypographyProps:{variant:"subtitle2"}})]}),p.author.id===(null===s||void 0===s?void 0:s.id)&&Object(W.jsxs)(za.a,{onClick:function(){m(),r(!0)},classes:{root:o.menuItem},children:[Object(W.jsx)(kt.a,{className:o.listItemIcon,children:Object(W.jsx)(jn.a,{fontSize:"small"})}),Object(W.jsx)(St.a,{primary:"Delete Post",primaryTypographyProps:{variant:"subtitle2"}})]}),p.author.id!==(null===s||void 0===s?void 0:s.id)&&Object(W.jsxs)(za.a,{onClick:m,classes:{root:o.menuItem},children:[Object(W.jsx)(kt.a,{className:o.listItemIcon,children:Object(W.jsx)(pn.a,{fontSize:"small"})}),Object(W.jsx)(St.a,{primary:"Report Post",primaryTypographyProps:{variant:"subtitle2"}})]})]}),Object(W.jsx)(On,{isOpen:n,handleClose:function(){return r(!1)},deletePost:h})]})}var yn=Object(Y.a)((function(e){return Object(X.a)({link:{display:"flex",flexGrow:1,alignItems:"center"},embed:{display:"flex",borderRadius:8,padding:e.spacing(1),marginBottom:e.spacing(1),backgroundColor:e.palette.grey[100],border:"1px solid ".concat(e.palette.grey[400])}})}));function wn(e){var t=e.post,a=e.page,r=Object(i.useState)(null),o=Object(Ce.a)(r,2),c=o[0],s=o[1],l=yn(),u=Re();return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",mb:2,children:[Object(W.jsxs)(U.a,{underline:"none",to:"/".concat(t.author.username),component:n.b,className:l.link,children:[Object(W.jsx)(et.a,{"aria-label":"avatar",src:t.author.avatar,alt:t.author.name}),Object(W.jsxs)(q.a,{ml:1,children:[Object(W.jsx)(J.a,{color:"textPrimary",variant:"subtitle2",component:"h6",noWrap:!0,children:t.author.name}),Object(W.jsx)(J.a,{color:"textSecondary",variant:"subtitle2",component:"h6",noWrap:!0,children:"@".concat(t.author.username)})]})]}),Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",ml:1,children:[Object(W.jsx)(J.a,{variant:"subtitle2",component:"h6",noWrap:!0,children:new Date(t.created_on).toLocaleDateString("en-gb",{month:"short",day:"numeric"})}),Object(W.jsx)(mt.a,{"aria-label":"dropdown",onClick:function(e){s(e.currentTarget)},children:Object(W.jsx)(un.a,{fontSize:"small"})})]})]}),Object(W.jsx)(vn,{anchorEl:c,page:a,post:t,cacheKey:"/users/".concat(t.author.username,"/posts"),closeMenu:function(){return s(null)},deletePost:function(){return u.mutate(t.id)}})]})}var kn=a(222),Sn=a.n(kn),Cn=a(223),Nn=a.n(Cn),Pn=a(221),In=a.n(Pn),_n=a(224),En=a.n(_n),Fn=a(791),Tn=a(792),zn=a(793),Ln=a(794),Wn=a(795),Dn=a(796),Rn=Object(Y.a)((function(e){return Object(X.a)({menuPaper:{borderRadius:e.spacing(4)},menuList:{display:"flex",alignItems:"center",paddingLeft:e.spacing(0),paddingRight:e.spacing(0)},gutters:{marginLeft:e.spacing(0),marginRight:e.spacing(0)},listItemIcon:{minWidth:32}})}));function Bn(e){var t=Rn(),a=e.url,n=e.tags,r=e.anchorEl,o=e.closeMenu;return Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(Ta.a,{keepMounted:!0,anchorEl:r,open:Boolean(r),onClose:o,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},classes:{paper:t.menuPaper,list:t.menuList},children:[Object(W.jsx)(za.a,{onClick:function(){return o()},classes:{gutters:t.gutters},children:Object(W.jsx)(kt.a,{classes:{root:t.listItemIcon},children:Object(W.jsx)(Fn.a,{url:a,hashtags:n,style:{height:32},children:Object(W.jsx)(Tn.a,{size:32,round:!0})})})}),Object(W.jsx)(za.a,{onClick:function(){return o()},classes:{gutters:t.gutters},children:Object(W.jsx)(kt.a,{classes:{root:t.listItemIcon},children:Object(W.jsx)(zn.a,{url:a,style:{height:32},children:Object(W.jsx)(Ln.a,{size:32,round:!0})})})}),Object(W.jsx)(za.a,{onClick:function(){return o()},classes:{gutters:t.gutters},children:Object(W.jsx)(kt.a,{classes:{root:t.listItemIcon},children:Object(W.jsx)(Wn.a,{url:a,style:{height:32},children:Object(W.jsx)(Dn.a,{size:32,round:!0})})})})]})})}function Mn(e){var t=e.post,a=e.page,n=e.cacheKey,r=Object(i.useState)(null),o=Object(Ce.a)(r,2),c=o[0],s=o[1],u=Object(i.useState)(!1),d=Object(Ce.a)(u,2),j=d[0],b=d[1],p=Object(i.useRef)(null),m=function(){localStorage.token&&M(localStorage.token);var e=Object(l.b)();return Object(be.a)(function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.post_id,e.next=3,B.a.post("/posts/".concat(a,"/likes"));case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onMutate:function(t){var a=t.pageIndex,n=t.post_id,r=t.key;e.setQueryData(r,(function(e){var t=null===e||void 0===e?void 0:e.pages[a];if(t){var r=null===t||void 0===t?void 0:t.data.map((function(e){return e.id===n&&(e.isLiked?(e.likes=e.likes-1,e.isLiked=!1):(e.likes=e.likes+1,e.isLiked=!0)),e}));null===e||void 0===e||e.pages.splice(a,1,{data:r,nextCursor:null===t||void 0===t?void 0:t.nextCursor})}return e}))},onError:function(e){console.log("Error: ",e.message)},onSettled:function(){return e.invalidateQueries()}})}();return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",justifyContent:"space-around",children:[!t.parent&&Object(W.jsxs)(mt.a,{"aria-label":"add comment",size:"small",onClick:function(){var e;b(!0),null===(e=p.current)||void 0===e||e.focus()},style:{marginRight:16},children:[Object(W.jsx)(J.a,{style:{marginRight:4},children:Object(W.jsx)("small",{children:t.comments})}),Object(W.jsx)(In.a,{fontSize:"small"})]}),Object(W.jsxs)(mt.a,{"aria-label":"add to favorites",size:"small",onClick:function(){return m.mutate({pageIndex:a,post_id:t.id,key:n})},children:[Object(W.jsx)(J.a,{style:{marginRight:4},children:Object(W.jsx)("small",{children:t.likes})}),t.isLiked?Object(W.jsx)(Sn.a,{color:"primary"}):Object(W.jsx)(Nn.a,{fontSize:"small"})]}),Object(W.jsx)(mt.a,{"aria-label":"share on social media",size:"small",onClick:function(e){s(e.currentTarget)},children:Object(W.jsx)(En.a,{fontSize:"small"})})]}),Object(W.jsx)(Bn,{url:"/posts/".concat(t.id),tags:t.tags,anchorEl:c,closeMenu:function(){return s(null)}}),Object(W.jsx)(Fa,{post_id:t.id,editorRef:p,cacheKey:n,isOpen:j,handleClose:function(){return b(!1)}})]})}function Hn(e){var t=e.post;return Object(W.jsxs)(q.a,{flexWrap:"wrap",display:"flex",alignItems:"center",justifyContent:"space-between",my:2,children:[Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",children:[Object(W.jsxs)(J.a,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:[Object(W.jsx)("strong",{children:null===t||void 0===t?void 0:t.likes})," ",1===(null===t||void 0===t?void 0:t.likes)?"like":"likes"]}),Object(W.jsxs)(J.a,{variant:"body2",color:"textSecondary",gutterBottom:!0,style:{marginLeft:16},children:[Object(W.jsx)("strong",{children:null===t||void 0===t?void 0:t.comments})," ",1===(null===t||void 0===t?void 0:t.comments)?"comment":"comments"]})]}),Object(W.jsx)(J.a,{color:"textSecondary",component:"span",gutterBottom:!0,children:Object(W.jsx)("small",{children:t&&new Date(null===t||void 0===t?void 0:t.created_on).toLocaleTimeString("en-gb",{hour12:!0,hour:"numeric",weekday:"long",minute:"numeric",month:"short",day:"numeric",year:"numeric"})})})]})}function Kn(e){var t=e.post,a=Object(i.useState)(!1),n=Object(Ce.a)(a,2),o=n[0],c=n[1],s=Object(i.useState)(!1),u=Object(Ce.a)(s,2),d=u[0],j=u[1],b=Object(i.useState)(null),p=Object(Ce.a)(b,2),m=p[0],h=p[1],x=Object(i.useRef)(null),g=Object(r.i)().postId,O=Object(l.b)(),f=Re(),v=he().data,y=Object(be.a)(function(){var e=Object(Q.a)(K.a.mark((function e(t){var a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.post("/posts/".concat(t,"/likes"));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onMutate:function(e){return O.setQueryData("/posts/".concat(e),(function(e){return e&&(console.log(e),e.isLiked?(e.likes=e.likes-1,e.isLiked=!1):(e.likes=e.likes+1,e.isLiked=!0)),e}))},onError:function(e){console.log("Error: ",e.message)},onSettled:function(){return O.invalidateQueries(["posts",g])}});return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",justifyContent:"space-around",children:[Object(W.jsx)(mt.a,{"aria-label":t.isLiked?"unlike post":"like post",onClick:function(){return y.mutate(t.id)},children:t.isLiked?Object(W.jsx)(Sn.a,{color:"primary"}):Object(W.jsx)(Nn.a,{fontSize:"small"})}),Object(W.jsx)(mt.a,{"aria-label":"add comment",onClick:function(){var e;c(!0),null===(e=x.current)||void 0===e||e.focus()},children:Object(W.jsx)(In.a,{fontSize:"small"})}),Object(W.jsx)(mt.a,{"aria-label":"share on social media",onClick:function(e){h(e.currentTarget)},children:Object(W.jsx)(En.a,{fontSize:"small"})}),t.author.id===(null===v||void 0===v?void 0:v.id)&&Object(W.jsx)(mt.a,{"aria-label":"delete post",onClick:function(){return j(!0)},children:Object(W.jsx)(jn.a,{fontSize:"small"})})]}),Object(W.jsx)(Bn,{url:"/posts/".concat(t.id),tags:t.tags,anchorEl:m,closeMenu:function(){return h(null)}}),Object(W.jsx)(Fa,{editorRef:x,isOpen:o,cacheKey:"/posts/".concat(parseInt(g),"/comments"),post_id:t.id,handleClose:function(){return c(!1)}}),Object(W.jsx)(On,{isOpen:d,handleClose:function(){return j(!1)},deletePost:function(){return f.mutate(t.id)}})]})}var Qn=Object(Y.a)((function(e){return Object(X.a)({paper:Object(A.a)({marginTop:4,padding:e.spacing(2)},e.breakpoints.down("xs"),{padding:e.spacing(2,1)})})}));function An(e){var t=e.post,a=e.cacheKey,n=e.page,r=Qn();return Object(W.jsxs)(Z.a,{elevation:0,component:"article",className:r.paper,children:[Object(W.jsx)(wn,{post:t,page:n}),Object(W.jsx)(nt,{post:t}),Object(W.jsx)(Mn,{post:t,page:n,cacheKey:a})]})}var Gn=function(e){var t=e.children,a=e.value,n=e.index,r=e.type,i=Object(c.a)(e,["children","value","index","type"]);return Object(W.jsx)("div",Object(o.a)(Object(o.a)({role:"tabpanel",hidden:a!==n,id:"".concat(r,"-tab"),"aria-labelledby":"".concat(r,"-tab")},i),{},{children:a===n&&t}))},qn=function(e){return{id:"".concat(e,"-tab"),"aria-controls":"".concat(e,"-tabpanel")}};function Vn(e){var t,a=e.url,n=e.cacheKey,r=Object(i.useRef)(null),o=De(n,a),c=o.data,s=o.error,l=o.isLoading,u=o.isError,d=o.hasNextPage,j=o.isFetchingNextPage,b=o.fetchNextPage;return en({enabled:d,target:r,onIntersect:function(){return b()}}),Object(W.jsx)(W.Fragment,{children:l?Object(W.jsx)(de,{}):u?Object(W.jsx)(q.a,{py:4,children:Object(W.jsx)(J.a,{color:"textSecondary",align:"center",children:null===s||void 0===s||null===(t=s.response)||void 0===t?void 0:t.data.message})}):Object(W.jsxs)(W.Fragment,{children:[null===c||void 0===c?void 0:c.pages.map((function(e,t){return Object(W.jsx)(i.Fragment,{children:e.data.map((function(e,a){return Object(W.jsx)(i.Fragment,{children:Object(W.jsx)(An,{post:e,page:t,cacheKey:n})},a)}))},t)})),Object(W.jsx)(je,{fullWidth:!0,resource:"posts",iconSize:24,ref:r,hasNextPage:d,isFetchingNextPage:j,fetchNextPage:function(){return b()},style:{textTransform:"capitalize"}})]})})}var Un=Object(Y.a)((function(e){return Object(X.a)({appbar:{boxShadow:e.shadows[0],backgroundColor:e.palette.background.paper},tab:{textTransform:"capitalize"}})}));function Zn(){var e=s.a.useState(0),t=Object(Ce.a)(e,2),a=t[0],n=t[1],r=Un(),c=1===a?[p,"top"]:[p,"latest"];return Object(W.jsxs)(sn,{cacheKey:c,title:"Home",children:[Object(W.jsx)($a,{avatar:!0,title:"home"}),Object(W.jsxs)(q.a,{flexGrow:1,mt:.5,children:[Object(W.jsx)(Ae.a,{position:"static",className:r.appbar,children:Object(W.jsxs)(dt.a,{value:a,onChange:function(e,t){n(t)},"aria-label":"Tag Tab",textColor:"primary",indicatorColor:"primary",variant:"fullWidth",children:[Object(W.jsx)(jt.a,Object(o.a)(Object(o.a)({label:"Latest"},qn("latest")),{},{className:r.tab})),Object(W.jsx)(jt.a,Object(o.a)(Object(o.a)({label:"Top"},qn("top")),{},{className:r.tab}))]})}),Object(W.jsx)(Gn,{type:"latest",value:a,index:0,children:Object(W.jsx)(Vn,{cacheKey:c,url:"/posts?latest=true"})}),Object(W.jsx)(Gn,{value:a,index:1,type:"top",children:Object(W.jsx)(Vn,{cacheKey:c,url:"/posts?top=true"})})]})]})}var Jn=Object(Y.a)((function(e){return Object(X.a)({title:{padding:e.spacing(2)},root:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",padding:e.spacing(2),borderBottom:"1px solid ".concat(e.palette.secondary.main),"&:hover":{backgroundColor:e.palette.secondary.light}},button:{marginLeft:e.spacing(1),textTransform:"lowercase"}})}));function Yn(){var e,t=Object(i.useRef)(null),a=Jn(),r=ye(),o=ve(),c=o.data,l=o.error,u=o.isLoading,d=o.isError,j=o.fetchNextPage,b=o.hasNextPage,p=o.isFetchingNextPage;en({enabled:b,target:t,onIntersect:function(){return j()}});var m=function(e){var t=e.followedBy.users,a=e.followedBy.count;return 1===t.length?"Followed by ".concat(t[0].profile.name):2===t.length&&0===a?"Followed by ".concat(t[0].profile.name," and ").concat(t[1].profile.name):"Followed by ".concat(t[0].profile.name,", ").concat(t[1].profile.name," and ").concat(a," others you follow.")};return Object(W.jsxs)(sn,{title:"Explore",description:"Search for tags and users.",children:[Object(W.jsx)($a,{back:!0,search:!0}),Object(W.jsxs)(Z.a,{elevation:0,style:{marginTop:4},children:[Object(W.jsx)(J.a,{className:a.title,children:Object(W.jsx)("strong",{children:"Popular Tags"})}),Object(W.jsx)(vt.a,{}),u?Object(W.jsx)(de,{}):d?Object(W.jsx)(q.a,{py:4,children:Object(W.jsx)(J.a,{color:"textSecondary",align:"center",children:null===l||void 0===l||null===(e=l.response)||void 0===e?void 0:e.data.message})}):Object(W.jsxs)(W.Fragment,{children:[null===c||void 0===c?void 0:c.pages.map((function(e,t){return Object(W.jsx)(s.a.Fragment,{children:e.data.map((function(e){return Object(W.jsx)(s.a.Fragment,{children:Object(W.jsxs)("div",{className:a.root,children:[Object(W.jsxs)(U.a,{underline:"none",to:"/tags/".concat(e.name),component:n.b,children:[Object(W.jsx)(J.a,{noWrap:!0,color:"textPrimary",variant:"subtitle1",children:Object(W.jsxs)("strong",{children:["#",e.name]})}),Object(W.jsx)(J.a,{color:"textPrimary",variant:"body2",children:m(e)})]}),Object(W.jsx)(ne.a,{variant:"outlined",color:"primary",size:"small",className:a.button,onClick:function(){return r.mutate({tag_id:e.id,pageIndex:t,key:O})},children:e.isFollowing?"unfollow":"follow"})]})},e.id)}))},t)})),Object(W.jsx)(je,{fullWidth:!0,resource:"tags",iconSize:16,ref:t,hasNextPage:b,isFetchingNextPage:p,fetchNextPage:function(){return j()},style:{textTransform:"capitalize"}})]})]})]})}var Xn=Object(Y.a)((function(e){var t;return Object(X.a)({listItemAvatar:Object(A.a)({},e.breakpoints.down("xs"),{minWidth:40}),avatar:Object(A.a)({},e.breakpoints.down("xs"),{width:32,height:32}),gutters:(t={},Object(A.a)(t,e.breakpoints.between("md","lg"),{paddingRight:e.spacing(1),paddingLeft:e.spacing(1)}),Object(A.a)(t,e.breakpoints.down("xs"),{paddingRight:e.spacing(1),paddingLeft:e.spacing(1)}),t)})}));function $n(e){var t,a,n,o,c,i=e.notif,s=Xn(),l=Object(r.g)();switch(i.subject){case"message":c={text:"sent you a message.",link:"/messages/".concat(null===(t=i.user.profile)||void 0===t?void 0:t.username)};break;case"follow":c={text:"started following you.",link:"/".concat(null===(a=i.user.profile)||void 0===a?void 0:a.username)};break;case"comment":c={text:"commented on your post.",link:"/posts/".concat(i.item_id)};break;case"like":c={text:"liked your post",link:"/posts/".concat(i.item_id)};break;default:c={text:"recently added a post.",link:"/posts/".concat(i.item_id)}}return Object(W.jsxs)(wt.a,{button:!0,classes:{gutters:s.gutters},onClick:function(){return l.push(c.link)},children:[Object(W.jsx)(Ua.a,{className:s.listItemAvatar,children:Object(W.jsx)(et.a,{alt:"Profile Picture",src:null===(n=i.user.profile)||void 0===n?void 0:n.avatar,className:s.avatar})}),Object(W.jsx)(St.a,{primary:Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(J.a,{variant:"body2",component:"p",children:[Object(W.jsx)("strong",{children:null===(o=i.user.profile)||void 0===o?void 0:o.name})," \xa0",c.text]}),Object(W.jsx)(J.a,{color:"textSecondary",gutterBottom:!0,noWrap:!0,children:Object(W.jsx)("small",{children:new Date(i.timestamp).toLocaleDateString("en-gb",{hour12:!0,hour:"numeric",weekday:"short",minute:"numeric",month:"numeric",day:"numeric",year:"numeric"})})})]}),secondary:Object(W.jsx)(W.Fragment,{children:i.post&&Object(W.jsx)(J.a,{variant:"body2",children:i.post.body})})})]})}var er=Object(Y.a)((function(e){return Object(X.a)({paper:{margin:"4px 0",padding:e.spacing(1,0,2)}})}));function tr(){var e,t=er(),a=Object(i.useRef)(null),n=(localStorage.token&&M(localStorage.token),Object(me.a)(m,function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.pageParam,n=void 0===a?0:a,e.next=3,B.a.get("/notifications?cursor=".concat(n));case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{getNextPageParam:function(e){var t;return null!==(t=e.nextCursor)&&void 0!==t&&t}})),r=n.data,o=n.error,c=n.isError,s=n.isLoading,l=n.fetchNextPage,u=n.isFetchingNextPage,d=n.hasNextPage;return en({enabled:d,target:a,onIntersect:function(){return l()}}),Object(W.jsxs)(sn,{title:"Notifications",children:[Object(W.jsx)($a,{back:!0,title:"Notifications"}),s?Object(W.jsx)(de,{}):c?Object(W.jsx)(q.a,{py:4,children:Object(W.jsx)(J.a,{color:"textSecondary",align:"center",children:null===o||void 0===o||null===(e=o.response)||void 0===e?void 0:e.data.message})}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Z.a,{square:!0,elevation:0,className:t.paper,children:Object(W.jsx)(yt.a,{disablePadding:!0,children:null===r||void 0===r?void 0:r.pages.map((function(e,t){return Object(W.jsx)(i.Fragment,{children:e.data.map((function(e,t){return Object(W.jsx)(i.Fragment,{children:Object(W.jsx)($n,{notif:e})},t)}))},t)}))})}),Object(W.jsx)(je,{fullWidth:!0,resource:"posts",iconSize:16,ref:a,hasNextPage:d,isFetchingNextPage:u,fetchNextPage:function(){return l()},style:{textTransform:"capitalize"}})]})]})}var ar=a(6),nr=Object(ar.a)((function(e){return Object(X.a)({badge:{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}})}))(ft.a),rr=Object(Y.a)((function(e){var t;return Object(X.a)({listItemAvatar:Object(A.a)({},e.breakpoints.down("xs"),{minWidth:40}),avatar:Object(A.a)({},e.breakpoints.down("xs"),{width:32,height:32}),gutters:(t={},Object(A.a)(t,e.breakpoints.between("md","lg"),{paddingRight:e.spacing(1),paddingLeft:e.spacing(1)}),Object(A.a)(t,e.breakpoints.down("xs"),{paddingRight:e.spacing(1),paddingLeft:e.spacing(1)}),t)})}));function or(e){var t=e.data,a=rr(),n=Object(r.g)();return Object(W.jsx)(yt.a,{disablePadding:!0,children:null===t||void 0===t?void 0:t.pages.map((function(e,t){return Object(W.jsx)(s.a.Fragment,{children:e.data.map((function(e,t){var r,o,c,i;return Object(W.jsx)(s.a.Fragment,{children:Object(W.jsxs)(wt.a,{button:!0,divider:!0,classes:{gutters:a.gutters},onClick:function(){var t;return n.push("/messages/".concat(null===(t=e.user)||void 0===t?void 0:t.profile.username))},children:[Object(W.jsx)(Ua.a,{className:a.listItemAvatar,children:e.isRead?Object(W.jsx)(et.a,{alt:"Profile Picture",src:null===(o=e.user)||void 0===o?void 0:o.profile.avatar,className:a.avatar}):Object(W.jsx)(nr,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",children:Object(W.jsx)(et.a,{alt:"Profile Picture",src:null===(r=e.user)||void 0===r?void 0:r.profile.avatar,className:a.avatar})})}),Object(W.jsx)(St.a,{primary:Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",children:[Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",flex:1,minWidth:0,children:[Object(W.jsx)(J.a,{style:{whiteSpace:"nowrap"},children:null===(c=e.user)||void 0===c?void 0:c.profile.name}),Object(W.jsx)(J.a,{variant:"body2",color:"textSecondary",noWrap:!0,style:{margin:"0 8px"},children:"@".concat(null===(i=e.user)||void 0===i?void 0:i.profile.username)})]}),Object(W.jsx)(J.a,{variant:"body2",color:"textSecondary",noWrap:!0,children:new Date(e.created_on).toLocaleDateString("en-us",{month:"numeric",day:"numeric",year:"numeric"})})]}),secondary:Object(W.jsx)(J.a,{noWrap:!0,variant:"body2",children:e.body})})]})},t)}))},t)}))})}function cr(){return localStorage.token&&M(localStorage.token),Object(me.a)(x,function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.pageParam,n=void 0===a?0:a,e.next=3,B.a.get("/chats?cursor=".concat(n));case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{getNextPageParam:function(e){var t;return null!==(t=e.nextCursor)&&void 0!==t&&t}})}var ir=Object(Y.a)((function(e){var t;return Object(X.a)({main:(t={},Object(A.a)(t,e.breakpoints.up("sm"),{marginLeft:104}),Object(A.a)(t,e.breakpoints.up("lg"),{marginLeft:244}),t),paper:{margin:"4px 0",overflow:"auto",height:"calc(100vh - 54px - 4px - 4px)",padding:e.spacing(1,0,2)}})}));function sr(){var e,t=ir(),a=Object(i.useRef)(null),n=Object(l.b)().getQueryData(d),r=cr(),o=r.data,c=r.error,s=r.isError,u=r.isLoading,j=r.fetchNextPage,b=r.hasNextPage,p=r.isFetchingNextPage;return en({enabled:b,target:a,onIntersect:function(){return j()}}),Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(te,{title:"Chats",description:null===n||void 0===n?void 0:n.profile.name}),Object(W.jsxs)(Ge.a,{maxWidth:"xl",disableGutters:!0,children:[Object(W.jsx)(pt.a,{xsDown:!0,children:Object(W.jsx)(Aa,{user:n})}),Object(W.jsx)("div",{className:t.main,children:Object(W.jsxs)(V.a,{container:!0,spacing:1,children:[Object(W.jsxs)(V.a,{item:!0,xs:12,md:6,children:[Object(W.jsx)($a,{title:"Messages",back:!0,search:!0}),Object(W.jsx)(Z.a,{square:!0,elevation:0,className:t.paper,children:u?Object(W.jsx)(de,{}):s?Object(W.jsx)(q.a,{py:4,children:Object(W.jsx)(J.a,{color:"textSecondary",align:"center",children:null===c||void 0===c||null===(e=c.response)||void 0===e?void 0:e.data.message})}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(or,{data:o}),Object(W.jsx)(je,{fullWidth:!0,iconSize:24,ref:a,hasNextPage:b,isFetchingNextPage:p,fetchNextPage:function(){return j()},style:{textTransform:"capitalize"}})]})})]}),Object(W.jsx)(pt.a,{smDown:!0,children:Object(W.jsx)(V.a,{item:!0,xs:12,md:6,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:Object(W.jsx)(J.a,{variant:"h6",children:"Click on a chat to display it here."})})})]})})]})]})}var lr=Object(Y.a)((function(e){return Object(X.a)({paper:Object(A.a)({marginTop:4,padding:e.spacing(2)},e.breakpoints.down("xs"),{padding:e.spacing(2,1)})})}));function ur(){var e,t,a,n=Object(i.useRef)(null),o=Object($.a)(),c=lr(),s=Object(r.i)().postId,l=(a=parseInt(s),localStorage.token&&M(localStorage.token),Object(pe.a)("/posts/".concat(a),Object(Q.a)(K.a.mark((function e(){var t;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get("/posts/".concat(a));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))))),u=l.data,d=l.isLoading,j=l.isError,b=l.error,p=he().data,m=De("/posts/".concat(s,"/comments"),"/posts/".concat(s,"/comments?")),h=m.data,x=m.error,g=m.isLoading,O=m.isError,f=m.fetchNextPage,v=m.hasNextPage,y=m.isFetchingNextPage;return en({enabled:v,target:n,onIntersect:function(){return f()}}),Object(W.jsxs)(sn,{title:"Post",children:[Object(W.jsx)($a,{back:!0,title:"Post",user:p}),Object(W.jsx)(Z.a,{elevation:0,component:"article",style:{marginTop:4,padding:o.spacing(2)},children:d?Object(W.jsx)(de,{}):j?Object(W.jsx)(q.a,{py:4,children:Object(W.jsx)(J.a,{color:"textSecondary",align:"center",children:null===b||void 0===b||null===(e=b.response)||void 0===e?void 0:e.data.message})}):Object(W.jsx)(W.Fragment,{children:u&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(wn,{post:u}),Object(W.jsx)(nt,{post:u,postPage:!0}),Object(W.jsx)(Hn,{post:u}),Object(W.jsx)(vt.a,{}),Object(W.jsx)(Kn,{post:u})]})})}),g?Object(W.jsx)(de,{}):O?Object(W.jsx)(q.a,{py:4,children:Object(W.jsx)(J.a,{color:"textSecondary",align:"center",children:null===x||void 0===x||null===(t=x.response)||void 0===t?void 0:t.data.message})}):Object(W.jsxs)(W.Fragment,{children:[null===h||void 0===h?void 0:h.pages.map((function(e,t){return Object(W.jsx)(i.Fragment,{children:e.data.map((function(e,a){return Object(W.jsx)(i.Fragment,{children:Object(W.jsxs)(Z.a,{elevation:0,component:"article",className:c.paper,children:[Object(W.jsx)(wn,{post:e,page:t}),Object(W.jsx)(nt,{post:e}),Object(W.jsx)(Mn,{post:e,page:t,cacheKey:"/posts/".concat(parseInt(s),"/comments")})]})},a)}))},t)})),Object(W.jsx)(je,{fullWidth:!0,resource:"comments",iconSize:24,ref:n,hasNextPage:v,isFetchingNextPage:y,fetchNextPage:function(){return f()},style:{textTransform:"capitalize"}})]})]})}var dr=a(411),jr=a.n(dr),br=a(410),pr=a.n(br),mr=Object(Y.a)((function(e){return Object(X.a)({paper:{margin:"4px 0",padding:e.spacing(1,1,2)},avatar:Object(A.a)({width:60,height:60,border:"2px solid ".concat(e.palette.primary.main)},e.breakpoints.up("sm"),{width:80,height:80}),flex:{display:"flex",alignItems:"center"},button:{marginRight:e.spacing(1),color:e.palette.text.primary,fontWeight:e.typography.fontWeightBold},marginRight:{marginRight:e.spacing(1)}})}));function hr(e){var t=e.user,a=e.page,o=e.meta,c=e.cacheKey,s=Object(i.useState)(!1),u=Object(Ce.a)(s,2),j=u[0],b=u[1],p=mr(),m=Object(r.i)().username,h=fe(),x=Object(l.b)().getQueryData(d);return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Z.a,{elevation:0,classes:{root:p.paper},children:Object(W.jsxs)(q.a,{display:"flex",children:[Object(W.jsx)(et.a,{src:t.profile.avatar,alt:"".concat(t.profile.username," gravatar"),className:p.avatar}),Object(W.jsxs)(q.a,{display:"flex",flexDirection:"column",flexGrow:1,ml:1,children:[Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",mb:1,children:[Object(W.jsxs)(q.a,{display:"flex",flexDirection:"column",flexGrow:1,mr:1,children:[Object(W.jsx)(J.a,{variant:"subtitle2",component:"h6",noWrap:!0,style:{fontWeight:600},children:t.profile.name}),Object(W.jsx)(J.a,{color:"textSecondary",variant:"subtitle2",component:"h6",noWrap:!0,children:t&&"@".concat(t.profile.username)})," "]}),(null===x||void 0===x?void 0:x.id)===t.id?Object(W.jsx)(ne.a,{variant:"outlined",color:"primary","aria-controls":"edit profile","aria-haspopup":"true",size:"small",disableElevation:!0,style:{textTransform:"capitalize"},onClick:function(){return b(!0)},children:"Edit Profile"}):t.isFollowing?Object(W.jsx)(ne.a,{variant:"outlined",color:"primary",size:"small",disableElevation:!0,style:{textTransform:"capitalize"},onClick:function(){return h.mutate({user_id:t.id,key:c,pageIndex:a,follow:t.isFollowing})},children:"following"}):Object(W.jsx)(ne.a,{variant:"outlined",color:"primary","aria-controls":"follow this user","aria-haspopup":"true",size:"small",disableElevation:!0,style:{textTransform:"capitalize"},onClick:function(){return h.mutate({user_id:t.id,key:c,pageIndex:a,follow:t.isFollowing})},children:"follow"})]}),Object(W.jsx)(J.a,{variant:"body2",component:"p",paragraph:!0,children:t?"".concat(t.profile.bio):""}),o&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",children:[Object(W.jsxs)(J.a,{variant:"body2",component:"p",color:"textSecondary",gutterBottom:!0,className:p.flex,children:[Object(W.jsx)(pr.a,{fontSize:"small",className:p.marginRight})," ","joined:"," ",t&&new Date(t.profile.created_on).toLocaleDateString("en-gb",{month:"short",year:"numeric",timeZone:"utc"})]}),Object(W.jsxs)(J.a,{variant:"body2",component:"p",color:"textSecondary",gutterBottom:!0,style:{marginLeft:16},className:p.flex,children:[Object(W.jsx)(jr.a,{fontSize:"small",className:p.marginRight})," ",t&&t.profile.dob?"dob: "+new Date(t.profile.dob).toLocaleDateString("en-gb",{month:"short",day:"numeric",timeZone:"utc"}):""]})]}),Object(W.jsx)(q.a,{display:"flex",alignItems:"center",children:Object(W.jsxs)(J.a,{variant:"body2",component:"p",color:"textSecondary",children:[Object(W.jsxs)(U.a,{color:"inherit",to:"/".concat(m,"/followers"),component:n.b,children:[Object(W.jsx)("span",{className:p.button,children:"".concat(t.followers)}),"Followers"]}),Object(W.jsxs)(U.a,{color:"inherit",to:"/".concat(m,"/following"),component:n.b,style:{marginLeft:24},children:[Object(W.jsx)("span",{className:p.button,children:"".concat(t.following)}),"Following"]})]})})]})]})]})}),Object(W.jsx)(Ba,{isOpen:j,user:t,handleClose:function(){return b(!1)}})]})}var xr=Object(Y.a)((function(e){return Object(X.a)({appbar:{boxShadow:e.shadows[0],backgroundColor:e.palette.background.paper},tab:{textTransform:"capitalize"}})}));function gr(){var e,t=s.a.useState(0),a=Object(Ce.a)(t,2),n=a[0],c=a[1],i=xr(),l=Object(r.i)().username,u=xe(l).data;switch(n){case 1:e=[b,"comments"];break;case 2:e=[b,"likes"];break;default:e=[b,"posts"]}return Object(W.jsxs)(sn,{cacheKey:e,title:"Profile",description:null===u||void 0===u?void 0:u.profile.name,children:[Object(W.jsx)($a,{back:!0,title:"".concat(null===u||void 0===u?void 0:u.profile.name," ")}),u&&Object(W.jsx)(hr,{meta:!0,user:u,cacheKey:[j,u.profile.username]}),Object(W.jsxs)(q.a,{flexGrow:1,mt:.5,children:[Object(W.jsx)(Ae.a,{position:"static",className:i.appbar,children:Object(W.jsxs)(dt.a,{value:n,onChange:function(e,t){c(t)},"aria-label":"Tag Tab",textColor:"primary",indicatorColor:"primary",variant:"fullWidth",children:[Object(W.jsx)(jt.a,Object(o.a)(Object(o.a)({label:"Posts"},qn("posts")),{},{className:i.tab})),Object(W.jsx)(jt.a,Object(o.a)(Object(o.a)({label:"Replies"},qn("replies")),{},{className:i.tab})),Object(W.jsx)(jt.a,Object(o.a)(Object(o.a)({label:"Favorites"},qn("likes")),{},{className:i.tab}))]})}),Object(W.jsx)(Gn,{type:"posts",value:n,index:0,children:Object(W.jsx)(Vn,{cacheKey:e,url:"/users/".concat(l,"/posts?")})}),Object(W.jsx)(Gn,{type:"replies",value:n,index:1,children:Object(W.jsx)(Vn,{cacheKey:e,url:"/users/".concat(l,"/comments?")})}),Object(W.jsx)(Gn,{value:n,index:2,type:"likes",children:Object(W.jsx)(Vn,{cacheKey:e,url:"/users/".concat(l,"/likes?")})})]})]})}var Or=a(232),fr=Object(Y.a)((function(e){return Object(X.a)({toolbar:{width:"100%",display:"flex",backgroundColor:e.palette.background.paper},button:{width:"100%",textTransform:"capitalize",minHeight:"54px",fontWeight:e.typography.fontWeightBold,padding:e.spacing(2),transition:e.transitions.create("all"),color:e.palette.text.secondary,"&:hover":{color:e.palette.primary.main}}})}));function vr(e){var t=e.username;return Object(W.jsx)(Ae.a,{position:"static",color:"default",elevation:0,children:Object(W.jsxs)(Ue.a,{children:[Object(W.jsx)(yr,{label:"followers",to:"/".concat(t,"/followers")}),Object(W.jsx)(yr,{label:"following",to:"/".concat(t,"/following")})]})})}function yr(e){var t=e.to,a=e.label,r=fr(),o=Object($.a)();return Object(W.jsx)(Or.a,{focusRipple:!0,className:r.button,component:n.c,activeStyle:{color:o.palette.primary.main},to:t,children:a})}function wr(){var e,t=Object(i.useRef)(null),a=Object(r.i)().username,n=xe(a).data,o=Oe("/users/".concat(a,"/followers")),c=o.data,s=o.error,l=o.isError,u=o.isLoading,d=o.fetchNextPage,j=o.hasNextPage,b=o.isFetchingNextPage;return en({enabled:j,target:t,onIntersect:function(){return d()}}),Object(W.jsxs)(sn,{title:"Followers",description:null===n||void 0===n?void 0:n.profile.name,children:[Object(W.jsx)($a,{back:!0,title:"".concat(null===n||void 0===n?void 0:n.profile.name),user:n,meta:"".concat(null===n||void 0===n?void 0:n.followers," followers")}),Object(W.jsx)(vr,{username:a}),u?Object(W.jsx)(de,{}):l?Object(W.jsx)(q.a,{py:4,children:Object(W.jsx)(J.a,{color:"textSecondary",align:"center",children:null===s||void 0===s||null===(e=s.response)||void 0===e?void 0:e.data.message})}):Object(W.jsxs)(W.Fragment,{children:[null===c||void 0===c?void 0:c.pages.map((function(e,t){return Object(W.jsx)(i.Fragment,{children:e.data.map((function(e,n){return Object(W.jsx)(i.Fragment,{children:Object(W.jsx)(hr,{user:e,page:t,cacheKey:"/users/".concat(a,"/followers")})},n)}))},t)})),Object(W.jsx)(je,{fullWidth:!0,resource:"followers",iconSize:16,ref:t,hasNextPage:j,isFetchingNextPage:b,fetchNextPage:function(){return d()},style:{textTransform:"capitalize"}})]})]})}function kr(){var e,t=Object(i.useRef)(null),a=Object(r.i)().username,n=xe(a).data,o=Oe("/users/".concat(a,"/following")),c=o.data,s=o.error,l=o.isError,u=o.isLoading,d=o.fetchNextPage,j=o.hasNextPage,b=o.isFetchingNextPage;return en({enabled:j,target:t,onIntersect:function(){return d()}}),Object(W.jsxs)(sn,{title:"Followers",description:null===n||void 0===n?void 0:n.profile.name,children:[Object(W.jsx)($a,{back:!0,title:"".concat(null===n||void 0===n?void 0:n.profile.name),user:n,meta:"".concat(null===n||void 0===n?void 0:n.following," following")}),Object(W.jsx)(vr,{username:a}),u?Object(W.jsx)(de,{}):l?Object(W.jsx)(q.a,{py:4,children:Object(W.jsx)(J.a,{color:"textSecondary",align:"center",children:null===s||void 0===s||null===(e=s.response)||void 0===e?void 0:e.data.message})}):Object(W.jsxs)(W.Fragment,{children:[null===c||void 0===c?void 0:c.pages.map((function(e,t){return Object(W.jsx)(i.Fragment,{children:e.data.map((function(e,n){return Object(W.jsx)(i.Fragment,{children:Object(W.jsx)(hr,{user:e,page:t,cacheKey:"/users/".concat(a,"/following")})},n)}))},t)})),Object(W.jsx)(je,{fullWidth:!0,resource:"users followed",iconSize:16,ref:t,hasNextPage:j,isFetchingNextPage:b,fetchNextPage:function(){return d()},style:{textTransform:"capitalize"}})]})]})}var Sr=a(277),Cr=a.n(Sr),Nr=a(413),Pr=a.n(Nr),Ir=a(412),_r=a.n(Ir),Er=Object(Y.a)((function(e){return Object(X.a)({menuPaper:{minWidth:"220px",padding:e.spacing(1)},menuItem:{minHeight:"32px"},listItemIcon:{color:"inherit",minWidth:0,alignItems:"center",marginRight:e.spacing(2)}})}));function Fr(e){var t=Er(),a=Object(l.b)().getQueryData(d),n=e.anchorEl,r=e.authorId,o=e.closeMenu,c=e.deleteMessage,i=e.deleteMessageForUser;return Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(Ta.a,{keepMounted:!0,anchorEl:n,open:Boolean(n),onClose:o,getContentAnchorEl:null,classes:{paper:t.menuPaper},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[Object(W.jsxs)(za.a,{onClick:function(){o(),i()},classes:{root:t.menuItem},children:[Object(W.jsx)(kt.a,{className:t.listItemIcon,children:Object(W.jsx)(jn.a,{fontSize:"small"})}),Object(W.jsx)(St.a,{primary:"Delete message for me",primaryTypographyProps:{variant:"subtitle2"}})]}),r===(null===a||void 0===a?void 0:a.id)&&Object(W.jsxs)(za.a,{onClick:function(){o(),c()},classes:{root:t.menuItem},children:[Object(W.jsx)(kt.a,{className:t.listItemIcon,children:Object(W.jsx)(_r.a,{fontSize:"small"})}),Object(W.jsx)(St.a,{primary:"Delete message for everyone",primaryTypographyProps:{variant:"subtitle2"}})]}),r!==(null===a||void 0===a?void 0:a.id)&&Object(W.jsxs)(za.a,{disabled:!0,onClick:function(){o()},classes:{root:t.menuItem},children:[Object(W.jsx)(kt.a,{className:t.listItemIcon,children:Object(W.jsx)(pn.a,{fontSize:"small"})}),Object(W.jsx)(St.a,{primary:"Report this message",primaryTypographyProps:{variant:"subtitle2"}})]})]})})}var Tr=Object(Y.a)((function(e){return Object(X.a)({msgBox:{"&:hover span":{visibility:"visible"}},authMsg:{position:"relative",borderTopLeftRadius:18,borderTopRightRadius:18,borderBottomLeftRadius:18,padding:e.spacing(1,2),color:e.palette.common.white,backgroundColor:e.palette.primary.dark},msgBody:{borderTopLeftRadius:18,borderTopRightRadius:18,borderBottomRightRadius:18,padding:e.spacing(1,2),backgroundColor:e.palette.secondary.main},form:{display:"flex",alignItems:"center",width:"100%"},more:{visibility:"hidden",margin:e.spacing(0,1)}})}));function zr(e){var t=e.message,a=e.pageIndex,n=e.username,r=Object(i.useState)(null),o=Object(Ce.a)(r,2),c=o[0],s=o[1],j=Tr(),b=Object(l.b)().getQueryData(d),p=function(){localStorage.token&&M(localStorage.token);var e=Object(l.b)();return Object(be.a)(function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.msg_id,n=t.userOnly,e.next=3,B.a.delete("/messages/".concat(a).concat(n?"?userOnly=true":""));case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onMutate:function(t){var a=t.msg_id,n=t.pageIndex,r=t.username;e.setQueryData([u,r],(function(e){var t=null===e||void 0===e?void 0:e.pages[n];if(t){var r=t.data.filter((function(e){return e.id!==a}));console.log(r),null===e||void 0===e||e.pages.splice(n,1,{data:r,nextCursor:null===t||void 0===t?void 0:t.nextCursor})}return console.log(e),e}))},onError:function(e){var t;console.log("Error: ",null===(t=e.response)||void 0===t?void 0:t.data.message)},onSettled:function(t,a,n){var r=n.username;e.invalidateQueries([u,r]),e.invalidateQueries(x)}})}();return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(q.a,{my:1,children:t.author_id===(null===b||void 0===b?void 0:b.id)?Object(W.jsx)(q.a,{display:"flex",alignItems:"center",justifyContent:"flex-end",className:j.msgBox,children:Object(W.jsxs)(q.a,{maxWidth:"90%",children:[Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",children:[Object(W.jsx)("span",{className:j.more,children:Object(W.jsx)(mt.a,{size:"small","aria-label":"delete message",onClick:function(e){return s(e.currentTarget)},children:Object(W.jsx)(Cr.a,{color:"disabled"})})}),Object(W.jsx)(J.a,{variant:"body2",className:j.authMsg,children:t.body})]}),Object(W.jsx)(J.a,{variant:"body2",align:"right",color:"textSecondary",children:Object(W.jsx)("small",{children:new Date(t.created_on).toLocaleDateString("en-gb",{hour12:!0,hour:"numeric",minute:"numeric",month:"short",day:"numeric",year:"numeric"})})})]})}):Object(W.jsx)(q.a,{display:"flex",alignItems:"center",className:j.msgBox,children:Object(W.jsxs)(q.a,{maxWidth:"90%",children:[Object(W.jsxs)(q.a,{display:"flex",alignItems:"center",children:[Object(W.jsx)(J.a,{variant:"body2",className:j.msgBody,children:t.body}),Object(W.jsx)("span",{className:j.more,children:Object(W.jsx)(mt.a,{size:"small","aria-label":"delete message",onClick:function(e){return s(e.currentTarget)},children:Object(W.jsx)(Cr.a,{color:"disabled"})})})]}),Object(W.jsx)(J.a,{variant:"body2",color:"textSecondary",children:Object(W.jsx)("small",{children:new Date(t.created_on).toLocaleDateString("en-gb",{hour12:!0,hour:"numeric",minute:"numeric",month:"short",day:"numeric",year:"numeric"})})})]})})}),Object(W.jsx)(Fr,{authorId:t.author_id,anchorEl:c,closeMenu:function(){return s(null)},deleteMessage:function(){return p.mutate({msg_id:t.id,username:n,pageIndex:a})},deleteMessageForUser:function(){return p.mutate({msg_id:t.id,username:n,pageIndex:a,userOnly:!0})}})]})}function Lr(e){var t=e.user,a=e.authorId,n=Object(i.useState)(""),r=Object(Ce.a)(n,2),o=r[0],c=r[1],s=Tr(),d=function(){localStorage.token&&M(localStorage.token);var e=Object(l.b)();return Object(be.a)(function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.message,n=t.to,e.next=3,B.a.post("/messages?user=".concat(n.id),{body:a});case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onMutate:function(t){var a=t.message,n=t.from,r=t.to;e.setQueryData([u,r.username],(function(e){return{pageParams:null===e||void 0===e?void 0:e.pageParams,pages:null===e||void 0===e?void 0:e.pages.map((function(e,t){return 0===t?{nextCursor:e.nextCursor,data:[{id:(new Date).getTime(),body:a,author_id:n,isRead:!1,created_on:new Date(Date.now()).toLocaleDateString("en-us",{hour12:!0,hour:"numeric",minute:"numeric",month:"short",day:"numeric",year:"numeric"})}].concat(Object(Le.a)(e.data))}:e}))}}))},onError:function(e){console.log("Error: ",e.message)},onSettled:function(t,a,n){var r=n.to;return e.invalidateQueries([u,r.username])}})}();return Object(W.jsxs)("form",{onSubmit:function(e){e.preventDefault(),o&&(d.mutate({message:o,to:t,from:a}),c(""))},className:s.form,children:[Object(W.jsx)(ae.a,{name:"message",placeholder:"Enter your message here...",type:"text",color:"secondary",value:o,onChange:function(e){return c(e.target.value)},fullWidth:!0}),Object(W.jsx)(mt.a,{type:"submit","aria-label":"send message",color:"primary",children:Object(W.jsx)(Pr.a,{})})]})}var Wr=Object(Y.a)((function(e){var t;return Object(X.a)({main:(t={},Object(A.a)(t,e.breakpoints.up("sm"),{marginLeft:104}),Object(A.a)(t,e.breakpoints.up("lg"),{marginLeft:244}),t),messages:{marginTop:4,overflow:"auto",height:"calc(100vh - 54px - 4px)"},paper:{margin:"4px 0",height:"calc(100vh - 54px - 56px - 4px - 4px)"},chatArea:{display:"flex",overflow:"auto",height:"100%",flexDirection:"column-reverse",padding:e.spacing(1)},button:{textTransform:"capitalize"},chatForm:{position:"static",right:0,bottom:0,width:"100%",padding:e.spacing(1,1,0)}})}));function Dr(){var e,t,a=Wr(),n=Object(i.useRef)(null),o=Object(i.useRef)(),c=Object(l.b)().getQueryData(d),s=Object(r.i)().username,j=xe(s).data,b=cr(),p=b.data,m=b.error,h=b.isError,x=b.isLoading,g=function(e){return localStorage.token&&M(localStorage.token),Object(me.a)([u,e],function(){var t=Object(Q.a)(K.a.mark((function t(a){var n,r,o;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.pageParam,r=void 0===n?0:n,t.next=3,B.a.get("/messages?username=".concat(e,"&cursor=").concat(r));case 3:return o=t.sent,t.abrupt("return",o.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{refetchInterval:1e3,getNextPageParam:function(e){var t;return null!==(t=e.nextCursor)&&void 0!==t&&t}})}("".concat(s)),O=g.data,f=g.error,v=g.isError,y=g.isLoading,w=g.fetchNextPage,k=g.hasNextPage,S=g.isFetchingNextPage;en({enabled:k,target:n,onIntersect:function(){return w()}});return Object(i.useEffect)((function(){o&&function(){var e;null===(e=o.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}()}),[p]),Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(te,{title:"Messages",description:null===c||void 0===c?void 0:c.profile.name}),Object(W.jsxs)(Ge.a,{maxWidth:"xl",disableGutters:!0,children:[Object(W.jsx)(pt.a,{xsDown:!0,children:Object(W.jsx)(Aa,{user:c})}),Object(W.jsx)("div",{className:a.main,children:Object(W.jsxs)(V.a,{container:!0,spacing:1,children:[Object(W.jsx)(pt.a,{smDown:!0,children:Object(W.jsxs)(V.a,{item:!0,xs:12,md:6,children:[Object(W.jsx)($a,{title:"Messages"}),x?Object(W.jsx)(de,{}):h?Object(W.jsx)(q.a,{py:4,children:Object(W.jsx)(J.a,{color:"textSecondary",align:"center",children:null===m||void 0===m||null===(e=m.response)||void 0===e?void 0:e.data.message})}):Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(Z.a,{square:!0,elevation:0,className:a.messages,children:Object(W.jsx)(or,{data:p})})})]})}),Object(W.jsxs)(V.a,{item:!0,xs:12,md:6,children:[j&&Object(W.jsx)($a,{avatar:!0,back:!0,title:j.profile.name,meta:j.profile.username,user:j}),Object(W.jsx)(Z.a,{square:!0,elevation:0,className:a.paper,children:y?Object(W.jsx)(de,{}):v?Object(W.jsx)(q.a,{py:4,children:Object(W.jsx)(J.a,{color:"textSecondary",align:"center",children:null===f||void 0===f||null===(t=f.response)||void 0===t?void 0:t.data.message})}):Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(q.a,{className:a.chatArea,children:[null===O||void 0===O?void 0:O.pages.map((function(e,t){return Object(W.jsx)(i.Fragment,{children:e.data.map((function(e,a){return Object(W.jsx)(i.Fragment,{children:Object(W.jsx)(zr,{message:e,pageIndex:t,username:null===j||void 0===j?void 0:j.profile.username})},a)}))},t)})),Object(W.jsx)(je,{fullWidth:!0,size:"small",resource:"messages",iconSize:16,ref:n,hasNextPage:k,isFetchingNextPage:S,fetchNextPage:function(){return w()},className:a.button})]})})}),Object(W.jsx)(Z.a,{square:!0,elevation:0,className:a.chatForm,children:j&&Object(W.jsx)(Lr,{user:{id:j.id,username:j.profile.username},authorId:null===c||void 0===c?void 0:c.id})})]})]})})]})]})}var Rr=Object(Y.a)((function(e){return Object(X.a)({appbar:{boxShadow:e.shadows[0],backgroundColor:e.palette.background.paper},tab:{textTransform:"capitalize"}})}));function Br(){var e=s.a.useState(0),t=Object(Ce.a)(e,2),a=t[0],n=t[1],c=Rr(),i=Object(r.i)().name,l=function(e){return localStorage.token&&M(localStorage.token),Object(pe.a)(["tag",e],Object(Q.a)(K.a.mark((function t(){var a;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.a.get("/tags?name=".concat(e));case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}),t)}))))}(i),u=l.data,d=l.isLoading,j=l.isError,b=d||j?"":"".concat(null===u||void 0===u?void 0:u.followedBy.count," following"),p=1===a?[f,"top"]:[f,"latest"];return Object(W.jsxs)(sn,{cacheKey:p,title:"Tags",description:"Select tags to follow",children:[Object(W.jsx)($a,{back:!0,title:"#".concat(i),meta:b}),Object(W.jsxs)(q.a,{flexGrow:1,mt:.5,children:[Object(W.jsx)(Ae.a,{position:"static",className:c.appbar,children:Object(W.jsxs)(dt.a,{value:a,onChange:function(e,t){n(t)},"aria-label":"Tag Tab",textColor:"primary",indicatorColor:"primary",variant:"fullWidth",children:[Object(W.jsx)(jt.a,Object(o.a)(Object(o.a)({label:"Latest"},qn("latest")),{},{className:c.tab})),Object(W.jsx)(jt.a,Object(o.a)(Object(o.a)({label:"Top"},qn("top")),{},{className:c.tab}))]})}),Object(W.jsx)(Gn,{type:"latest",value:a,index:0,children:Object(W.jsx)(Vn,{cacheKey:p,url:"/tags/".concat(i,"?latest=true")})}),Object(W.jsx)(Gn,{value:a,index:1,type:"top",children:Object(W.jsx)(Vn,{cacheKey:p,url:"/tags/".concat(i,"?top=true")})})]})]})}function Mr(){return Object(W.jsx)(n.a,{children:Object(W.jsxs)(r.d,{children:[Object(W.jsx)(r.b,{exact:!0,path:v,children:Object(W.jsx)(st,{})}),Object(W.jsx)(r.b,{exact:!0,path:w,children:Object(W.jsx)(Qe,{})}),Object(W.jsx)(r.b,{exact:!0,path:y,children:Object(W.jsx)(ke,{})}),Object(W.jsx)(D,{exact:!0,path:S,children:Object(W.jsx)(Zn,{})}),Object(W.jsx)(D,{exact:!0,path:C,children:Object(W.jsx)(Yn,{})}),Object(W.jsx)(D,{exact:!0,path:z,children:Object(W.jsx)(ur,{})}),Object(W.jsx)(D,{exact:!0,path:_,children:Object(W.jsx)(Br,{})}),Object(W.jsx)(D,{exact:!0,path:I,children:Object(W.jsx)(sr,{})}),Object(W.jsx)(D,{exact:!0,path:P,children:Object(W.jsx)(Dr,{})}),Object(W.jsx)(D,{exact:!0,path:N,children:Object(W.jsx)(tr,{})}),Object(W.jsx)(D,{exact:!0,path:E,children:Object(W.jsx)(gr,{})}),Object(W.jsx)(D,{exact:!0,path:F,children:Object(W.jsx)(wr,{})}),Object(W.jsx)(D,{exact:!0,path:T,children:Object(W.jsx)(kr,{})})]})})}B.a.defaults.baseURL="https://witti.herokuapp.com/api",B.a.defaults.headers.post["Content-Type"]="application/json"},737:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(29),c=a.n(o),i=a(802),s=a(196),l=a(379),u=a(783),d=a(798),j=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,813)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),o(e),c(e)}))},b=a(415),p="light",m="#14b89c",h=Object(b.a)({palette:{primary:{main:m},secondary:{main:"#e1e8ec"},background:{default:"#e1e8ec",paper:"#fafafa"},type:p},mixins:{toolbar:{minHeight:"54px"}},typography:{h1:{fontSize:"3.5rem"},h2:{fontSize:"3rem"},h3:{fontSize:"2.5rem"},h4:{fontSize:"2rem"},h5:{fontSize:"1.5rem"},h6:{fontSize:"1.2rem"}}}),x=a(1),g=new i.a;!function(){var e=a(736).default;c.a.render(Object(x.jsxs)(u.a,{theme:h,children:[Object(x.jsx)(d.a,{}),Object(x.jsx)(r.a.StrictMode,{children:Object(x.jsxs)(s.a,{client:g,children:[Object(x.jsx)(e,{}),Object(x.jsx)(l.ReactQueryDevtools,{})]})})]}),document.getElementById("root"))}(),j(console.log)}},[[737,1,2]]]);
//# sourceMappingURL=main.dbc4030a.chunk.js.map